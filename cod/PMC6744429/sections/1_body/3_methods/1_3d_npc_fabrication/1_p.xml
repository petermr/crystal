<?xml version="1.0" encoding="UTF-8"?>
<p id="Par19">We utilize a typical femtosecond-laser writing system for fabricating 3D microstructures in 5% MgO-doped LiNbO
 <sub>3</sub> crystals. The light source of the system is a mode-locked Ti:sapphire laser collocated with a regenerative amplifier (Legend Elite-1K-HE Coherent). This laser produces high intensity pulses at 800 nm wavelength, with a 104 fs pulse duration at 1 kHz pulse repetition rate. In our system, we use a half-wave plate and a Glan Prism to control the power of the laser beam. The laser beam is focused into the LiNbO
 <sub>3</sub> crystal by an objective (50×, N.A. = 0.8) along the 
 <italic>z</italic>-axis after being expanded by a beam expander system. The size of the focal spot inside the crystal is approximately 1.5 μm in 
 <italic>X</italic> and 
 <italic>Y</italic> directions and 3 μm in 
 <italic>Z</italic> direction, which decides the laser writing resolution. During femtosecond processing, the sample position is precisely controlled by a nanopositioning stage (model E-545, Physik Instrumente GmbH &amp; Co. KG) with moving ranges of 200 μm (
 <italic>x</italic>) × 200 μm (
 <italic>y</italic>) × 200 μm (
 <italic>z</italic>) and a spatial resolution of 1 nm. We can observe the fabricating process through a Charge-Coupled-Device camera in real time. The writing energy is 180 nJ with scanning speed 50 μm s
 <sup>−1</sup> to fabricate 3D nonlinear fork-gratings for SH vortex beam shaping. To fabricate the 3D NPC structure for SH HG(1, 1) beam generation, the laser writing energies are 110 nJ and 150 nJ for the top and bottom layers along the 
 <italic>z</italic>-axis, respectively. The scanning speed is 50 μm s
 <sup>−1</sup>. The written volumes are limited by the instability of the femtosecond-laser writing system.
</p>
