<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">EJNMMI Phys</journal-id><journal-id journal-id-type="iso-abbrev">EJNMMI Phys</journal-id><journal-title-group><journal-title>EJNMMI Physics</journal-title></journal-title-group><issn pub-type="epub">2197-7364</issn><publisher><publisher-name>Springer International Publishing</publisher-name><publisher-loc>Cham</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6663957</article-id><article-id pub-id-type="publisher-id">248</article-id><article-id pub-id-type="doi">10.1186/s40658-019-0248-9</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Research</subject></subj-group></article-categories><title-group><article-title>Implementation of cylindrical PET scanners with block detector geometry in STIR</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8563-3450</contrib-id><name><surname>Khateri</surname><given-names>Parisa</given-names></name><address><email>pkhateri@phys.ethz.ch</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Fischer</surname><given-names>Jannis</given-names></name><address><email>fischeja@phys.ethz.ch</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Lustermann</surname><given-names>Werner</given-names></name><address><email>Werner.Lustermann@cern.ch</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Tsoumpas</surname><given-names>Charalampos</given-names></name><address><email>C.Tsoumpas@leeds.ac.uk</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Dissertori</surname><given-names>G&#x000fc;nther</given-names></name><address><phone>+41 44 633 42 88</phone><email>disserto@phys.ethz.ch</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2156 2780</institution-id><institution-id institution-id-type="GRID">grid.5801.c</institution-id><institution>Institute for Particle Physics and Astrophysics, Department of Physics, </institution><institution>ETH Z&#x000fc;rich, </institution></institution-wrap>Z&#x000fc;rich, Switzerland </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8403</institution-id><institution-id institution-id-type="GRID">grid.9909.9</institution-id><institution>Leeds Institute of Cardiovascular and Metabolic Medicine, </institution><institution>University of Leeds, </institution></institution-wrap>Leeds, UK </aff></contrib-group><pub-date pub-type="epub"><day>29</day><month>7</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>29</day><month>7</month><year>2019</year></pub-date><pub-date pub-type="collection"><month>12</month><year>2019</year></pub-date><volume>6</volume><elocation-id>15</elocation-id><history><date date-type="received"><day>1</day><month>11</month><year>2018</year></date><date date-type="accepted"><day>5</day><month>7</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s). 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p id="Par1">Software for Tomographic Image Reconstruction (STIR) is an open-source library for PET and SPECT image reconstruction, implementing iterative reconstruction as well as 2D- and 3D-filtered back projection. Quantitative reconstruction of PET data requires the knowledge of the scanner geometry. Typical scanners, clinical as well as pre-clinical ones, use a block-type geometry. Several rectangular blocks of crystals are arranged into regular polygons. Multiple of such polygons are arranged along the scanner axis. However, the geometrical representation of a scanner provided by STIR is a cylinder made of rings of individual crystals equally distributed in axial and transaxial directions. The data of realistic scanners are projected onto such virtual scanners prior to image reconstruction. This results in reduced quality of the reconstructed image. In this study, we implemented the above-described block geometry into the STIR library, permitting the image reconstruction without the interpolation step. In order to evaluate the difference in image quality, we performed Monte Carlo simulation studies of three different scanner designs: two scanners with multiple crystals per block and one with a single crystal per block. Simulated data were reconstructed using the standard STIR method and the newly implemented block geometry.</p></sec><sec><title>Results</title><p id="Par2">Visual comparison between the images reconstructed by the two models for the block-type scanners shows that the new implementation enhances the image quality to the extent that the results before normalization correction are comparable with those after normalization correction. The simulation result of a uniform cylinder shows that the coefficient of variation decreases from 25.8% to 20.9% by using the new implementation in STIR. Spatial resolution is enhanced resulting in a lower partial loss of intensity in sources of small size, e.g., the spill-over ratio for spherical sources of 1.8&#x02009;mm diameter is 0.19 in the block and 0.34 in the cylindrical model.</p></sec><sec><title>Conclusions</title><p id="Par3">Results indicate a significant improvement for the new model in comparison with the old one which mapped the polygonal geometry into a cylinder. The new implementation was tested and is available for use via the library of Swiss Federal Institute of Technology in Zurich (ETH).</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>PET image reconstruction</kwd><kwd>SAFIR</kwd><kwd>Scanner geometry</kwd><kwd>STIR</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003006</institution-id><institution>Eidgen&#x000f6;ssische Technische Hochschule Z&#x000fc;rich</institution></institution-wrap></funding-source><award-id>ETH-30 14-2</award-id></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p id="Par18">Positron emission tomography (PET) allows quantitative imaging of the radiotracer&#x02019;s distribution inside the object under study. There is a strong demand in pre-clinical PET imaging for accurate reconstruction procedure to acquire quantitative images of high spatial resolution. Iterative image reconstruction methods are especially of interest as they yield accurate quantitative images [<xref ref-type="bibr" rid="CR1">1</xref>]. They can incorporate physical effects of the system into the reconstruction model and enhance the spatial resolution [<xref ref-type="bibr" rid="CR2">2</xref>]. One of the fundamental components in iterative reconstruction algorithms is the system matrix which models the scanner response [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. Different methods have been developed to derive the system matrix. One method is to measure a point source located in different positions in the scanner field of view (FOV) [<xref ref-type="bibr" rid="CR5">5</xref>]. Another approach is to obtain the system matrix using Monte Carlo simulation [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. Such simulations can include both geometrical and physical properties of the system but they are computationally challenging. An alternative is to analytically calculate the line of intersection between image voxels and lines of response (LOR) [<xref ref-type="bibr" rid="CR8">8</xref>]. In the analytical approach, the system matrix can be decomposed into different components to take into account various resolution-degrading effects [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>], as follows:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ q= NLXf+s+r $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">NLXf</mml:mtext><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi></mml:math><graphic xlink:href="40658_2019_248_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par19">This equation is used as the forward model in the well-known expectation maximization algorithm [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. It describes the mean of the measured data, vector <bold><italic>q</italic></bold>, as a function of the radiotracer&#x02019;s distribution, vector <bold><italic>f</italic></bold>. Diagonal matrices of <italic>N</italic> and <italic>L</italic> represent normalization and attenuation correction, respectively. Vectors of <bold><italic>s</italic></bold> and <bold><italic>r</italic></bold> are estimates of the mean of scatter and random events, respectively. Matrix <italic>X</italic> is the geometric model that relates the projection space to the image space. This geometric element is directly dependent on the model of the scanner geometry. In this study, we concentrate on this key component of the system matrix and in particular its implementation in STIR (Software for Tomographic Image Reconstruction) [<xref ref-type="bibr" rid="CR12">12</xref>]. STIR is an open-source library for PET and SPECT image reconstruction, implementing analytical as well as iterative reconstruction. Within STIR, the system matrix is calculated based on the analytical method with the Siddon raytracing algorithm [<xref ref-type="bibr" rid="CR13">13</xref>]. The geometrical representation of a scanner provided by STIR is a cylinder made of rings of individual crystals equally distributed in axial and transaxial directions. The data of realistic scanners are projected onto such virtual scanners prior to image reconstruction. Whereas, typical scanners, clinical as well as pre-clinical ones, use a block-type geometry. Several rectangular blocks of crystals are arranged into regular polygons. Multiple of such polygons are arranged, with equal spacing, along the scanner axis. Gaps between individual crystals within a block are typically different from the gaps between the blocks in axial and transaxial directions. The difference between these two models, in a transaxial direction, is schematically shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematics of scanner models. <bold>a</bold> Cylindrical geometry. <bold>b</bold> Block geometry</p></caption><graphic xlink:href="40658_2019_248_Fig1_HTML" id="MO1"/></fig></p><p id="Par20">We implemented the block geometry in both axial and transaxial directions in the STIR library and investigated if the implementation of such a realistic model is worth the time and computational expense. The new implemented model permits the image reconstruction without the interpolation step. Therefore, LORs can be described more accurately which in turn leads to more accurate localization of radiotracers. Details of the implementation along with the evaluation of the reconstruction are described in the next sections.</p></sec><sec id="Sec2"><title>Methods</title><sec id="Sec3"><title>Software implementation</title><p id="Par21">The new block geometry was implemented in STIR version 3.0. STIR makes use of the object-oriented features of C++. The library contains main building blocks including categorized classes to describe certain kinds of object with their functionalities, e.g., to describe images, 3D sinograms, forward/backward projection, iterative image reconstruction algorithms, and reading/writing interfile headers (I/O) [<xref ref-type="bibr" rid="CR12">12</xref>]. We now describe these features in more detail.</p><p id="Par22">The class <italic>Scanner</italic> describes the characteristics of a cylindrical scanner with discrete detectors. It lacks parameters to be able to model the exact block geometry, e.g., the distance between crystals in the axial and transaxial directions and the distance between blocks in the axial direction. We added these new parameters to the class <italic>Scanner</italic> and to the I/O-related classes accordingly. Moreover, the interfile headers were modified such that the user can choose at run-time which geometry to use, either <italic>cylindrical</italic> or <italic>blocks-on-cylindrical</italic>.</p><p id="Par23">The library has been extended to be able to read custom input file formats, for instance, the Small Animal PET Insert For MRI (SAFIR) list-mode data for a cylindrical scanner, and to histogram them in 3D sinograms [<xref ref-type="bibr" rid="CR14">14</xref>]. This part was adapted to cope with the new block geometry as well. In the cylindrical implementation, sinogram bin parameters are found from the LOR Cartesian coordinates. Bin parameters are segment, axial-position, view, and tangential-position numbers. We overloaded a function to calculate the sinogram bin parameters directly from the detector position numbers.</p><p id="Par24">The most important building block to modify was the one related to sinograms and forward/backward projection. New classes were inherited in which the 3D-sinogram information could be calculated according to the new scanner geometry. Figure&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref> demonstrates the related class hierarchy. In the former model, the LOR coordinates are calculated based on detector position numbers with the assumption of having a perfect cylindrical scanner. In the current implementation, we calculate LOR coordinates from the exact Cartesian coordinates of the two detection positions. The detection positions are calculated based on the average depth of interaction inside the crystals. In both geometries, it is possible to use LOR sampling in a tangential direction. It means that multiple rays could be used in raytracing for each detector pair. In this case, the spatial sampling is evenly distributed and the result is averaged over different LORs.<fig id="Fig2"><label>Fig. 2</label><caption><p>Class hierarchy related to sinogram data. Arrows indicate the parent class. Gray boxes show the new classes added to the library. The classes <italic>ProjDataInfoBlocksOnCylindrical</italic> and <italic>ProjDataInfoBlocksOnCylindricalNoArcCorr</italic> store and calculate the sinogram LOR and bin information for the block geometry. The class <italic>GeometryBlocksOnCylindrical</italic> builds a map of Cartesian coordinates of detectors according to the scanner geometry</p></caption><graphic xlink:href="40658_2019_248_Fig2_HTML" id="MO2"/></fig></p></sec><sec id="Sec4"><title>Monte Carlo simulations</title><p id="Par25">We simulated three sets of PET data with different scanner designs using Geant4 toolkit v10.2 [<xref ref-type="bibr" rid="CR15">15</xref>] and Gate v7.2 [<xref ref-type="bibr" rid="CR16">16</xref>]: a scanner with a single crystal per block to test the code implementation and two scanners with multiple crystals per block but different crystal sizes to evaluate the new model. Details of the simulation setup are described as follows.</p><sec id="Sec5"><title>The scanner with a single crystal per block&#x02014;Scanner A</title><p id="Par26">This scanner, simulated using Geant4 toolkit, is built of 41 rings evenly distributed in axial direction comprising 180 detector elements uniformly distributed per ring. The crystal size is 2.0&#x02009;&#x000d7;&#x02009;2.0&#x02009;&#x000d7;&#x02009;12.0&#x02009;mm<sup>3</sup>, and the inner ring radius is 63.02&#x02009;mm. The crystal pitches in axial and transaxial directions are 2.2&#x02009;mm.</p><p id="Par27">A Derenzo phantom with spherical sources of 1.0, 1.2, 1.6, 2.4, 3.2, and 4.0&#x02009;mm diameter was simulated inside this scanner. The spheres were filled with 500&#x02009;MBq of <sup>18</sup>F and located inside a water cylinder with 25&#x02009;mm diameter. The activity was distributed uniformly inside the spheres. Simulation was performed for 5&#x02009;s.</p></sec><sec id="Sec6"><title>The block-type scanner with 2.1&#x02009;&#x000d7;&#x02009;2.1&#x02009;&#x000d7;&#x02009;12&#x02009;mm<sup>3</sup> crystals&#x02014;Scanner B</title><p id="Par28">The geometry of this scanner is similar to the SAFIR prototype scanner [<xref ref-type="bibr" rid="CR17">17</xref>]. It is composed of 2 (24) blocks of 8&#x02009;&#x000d7;&#x02009;8 detectors in axial (transaxial) direction. The blocks are arranged on a dodecagon prism, i.e., there are two blocks per module, each module on one side of the prism. The inner radius of the scanner is 67.75&#x02009;mm. The crystal size is 2.1&#x02009;&#x000d7;&#x02009;2.1&#x02009;&#x000d7;&#x02009;12.0&#x02009;mm<sup>3</sup>. Crystal gap and block gap are 0.1&#x02009;mm and 0.6&#x02009;mm, respectively, in both axial and transaxial directions.</p><p id="Par29">Several phantoms were simulated inside this scanner using Gate v7.2. The first one was a rotating plane (32&#x02009;mm&#x02009;&#x000d7;&#x02009;120&#x02009;mm) source simulated to find the normalization correction factors. The plane was rotated at six equally spaced angles over a total of 180&#x000b0;. Since the scanner has 12 modules of detector blocks, this assures that the number of detected LORs, which are orthogonal to the plane, is maximized. The source activity was set to 10&#x02009;MBq at each angular position. The acquisition time was 80&#x02009;min per position. We used back-to-back emission of two 511-keV gammas, thus, the non-collinearity and positron range was not simulated in this set of data. The plane was filled with air to avoid scatter and attenuation effects. The decay was turned off. This increases the statistics per detector pair and therefore reduces the statistical error introduced by the normalization.</p><p id="Par30">A uniform water-filled cylinder (25&#x02009;mm&#x02009;&#x000d7;&#x02009;60&#x02009;mm &#x000d8;) which contained 100&#x02009;MBq of <sup>18</sup>F was simulated for 2.5&#x02009;min.</p><p id="Par31">A point source consisting of 10&#x02009;MBq of <sup>22</sup>Na was embedded inside an acrylic cube of 10.0&#x02009;mm extended on all sides as suggested in NEMA NU 4 [<xref ref-type="bibr" rid="CR18">18</xref>]. The source was located at the axial center and one-fourth of the axial FOV. For both axial positions, the source was moved radially at positions of 0.0, 5.0, 10.0, 15.0, 20.0, 25.0&#x02009;mm. 10<sup>5</sup> prompts were stored for each position.</p><p id="Par32">A Derenzo phantom with sphere diameters of 1.6, 1.8, 2.0, 2.2, 2.4, and 2.8&#x02009;mm made of water was used in order to evaluate the effect of spatial resolution on the image quality. The initial activity of 100&#x02009;MBq of <sup>18</sup>F was distributed uniformly inside the spheres, with the same activity per volume in the spheres. The acquisition time was 5&#x02009;s. The spheres were located inside a water cylinder with 25&#x02009;mm length and 30&#x02009;mm diameter. Therefore, the effect of positron range was present in the simulation.</p><p id="Par33">The image quality phantom as described in NEMA NU 4 [<xref ref-type="bibr" rid="CR18">18</xref>] consisting of 3.7&#x02009;MBq of <sup>18</sup>F was simulated for 20&#x02009;min. The image quality phantom has two parts. One part of 20&#x02009;mm inner length includes five hot rods of different diameters (1.0, 2.0, 3.0, 4.0, and 5.0&#x02009;mm) inside a polymethylmethacrylate (PMMA) cylinder. The other part of 30&#x02009;mm inner length comprises of two cold rods of the same diameter (8.0&#x02009;mm) inside a hot cylinder. Since the scanner is not long enough to cover the whole phantom, we had to repeat the same simulation with two different axial positions of the phantom so that in each simulation, one part is axially centered in the scanner.</p></sec><sec id="Sec7"><title>The block-type scanner with 1&#x02009;&#x000d7;&#x02009;1&#x02009;&#x000d7;&#x02009;10&#x02009;mm<sup>3</sup> crystals&#x02014;Scanner C</title><p id="Par34">In order to validate if the results are independent of the crystal size, a similar block-type scanner with smaller crystals (1.0&#x02009;&#x000d7;&#x02009;1.0&#x02009;&#x000d7;&#x02009;10.0&#x02009;mm<sup>3</sup>) was simulated using Gate v7.2. The scanner is made of 2 (24) blocks of 16&#x02009;&#x000d7;&#x02009;16 detectors in an axial (transaxial) direction where the blocks are arranged on a dodecagon prism. The inner radius of the scanner is 67&#x02009;mm. Cristal gap and block gap are 0.1 and 0.3, respectively.</p><p id="Par35">A Derenzo phantom, with spheres of 0.6, 0.8, 1.0, 1.2, 1.5, and 2.0&#x02009;mm diameter made of water was placed inside the scanner. The spheres were uniformly filled by the total activity of 100&#x02009;MBq of <sup>18</sup>F and were simulated for 5&#x02009;s. The spheres were located inside a water cylinder with 25&#x02009;mm length and 30&#x02009;mm diameter.</p></sec></sec><sec id="Sec8"><title>Sorting coincidence data</title><p id="Par36">The coincidence data were sorted using a coincidence time window of 1&#x02009;ns and an energy window from 350&#x02009;keV to 650&#x02009;keV which is common in preclinical studies. Random events were removed from simulated data by checking the event history in the Monte Carlo simulation data.</p><p id="Par37">List-mode simulated data were histogrammed into 3D sinograms of types block and cylindrical. Each sinogram bin represents one LOR, i.e., no compression was implemented in axial and transaxial directions. The sizes of sinogram data for the three scanners are summarized in Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Size of sinograms and images with their dimensions for the three different scanners</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Scanner</th><th>Size of sinograms</th><th>1Number of sinograms</th><th>Number of image voxels</th><th>Image voxel size (mm<sup>3</sup>)</th></tr></thead><tbody><tr><td align="center">Scanner A</td><td align="center">90&#x02009;&#x000d7;&#x02009;60</td><td align="center">1681</td><td align="center">127&#x02009;&#x000d7;&#x02009;127&#x02009;&#x000d7;&#x02009;81</td><td align="center">0.55&#x02009;&#x000d7;&#x02009;0.55&#x02009;&#x000d7;&#x02009;1.1</td></tr><tr><td align="center">Scanner B</td><td align="center">&#x02009;&#x02009;&#x02009;96&#x02009;&#x000d7;&#x02009;100</td><td align="center">256</td><td align="center">129&#x02009;&#x000d7;&#x02009;129&#x02009;&#x000d7;&#x02009;31</td><td align="center">0.55&#x02009;&#x000d7;&#x02009;0.55&#x02009;&#x000d7;&#x02009;1.1</td></tr><tr><td align="center">Scanner C</td><td align="center">192&#x02009;&#x000d7;&#x02009;100</td><td align="center">1024</td><td align="center">213&#x02009;&#x000d7;&#x02009;213&#x02009;&#x000d7;&#x02009;63</td><td align="center">0.257&#x02009;&#x000d7;&#x02009;0.257&#x02009;&#x000d7;&#x02009;0.55</td></tr></tbody></table></table-wrap></p></sec><sec id="Sec9"><title>Normalization</title><p id="Par38">Normalization factors were only calculated for the <italic>Scanner B</italic>. The method described by Bailey et al. [<xref ref-type="bibr" rid="CR19">19</xref>] was adapted for this purpose in the following manner. Six data sets were acquired from six angular positions of the plane. The goal was to extract the LORs that were almost orthogonal to the plane source at each position. We extracted 16 almost orthogonal views per position. Therefore, all views were covered because there were 96 views in total. The extracted views were assembled to build a complete 3D sinogram. The symmetric views and axial positions were added together to increase the statistics per sinogram bins. The average number of counts per sinogram bin was about 1000. This gives a statistical error of ~&#x02009;3.2%. The bin values were then inverted to calculate the normalization factors. The sinograms were trimmed to 160 tangential positions to remove bins out of the desired FOV.</p></sec><sec id="Sec10"><title>Attenuation correction</title><p id="Par39">Generation of the attenuation maps was quite straightforward since the data were from Monte Carlo simulation and we knew the exact phantom geometry and the material. The attenuation coefficient used for water was 0.096&#x02009;cm<sup>&#x02212;1</sup> at 511&#x02009;keV [<xref ref-type="bibr" rid="CR20">20</xref>]. The attenuation correction sinograms were calculated from the exponential of the forward projection of the attenuation maps for both cylindrical and block geometries.</p></sec><sec id="Sec11"><title>Scatter correction</title><p id="Par40">The scatter estimation was performed using the current implementation of single scatter simulation (SSS) algorithm in STIR [<xref ref-type="bibr" rid="CR21">21</xref>] where the Klein-Nishina cross-section is used to calculate the probability of Compton scattering as a function of scattering angle. We calculated the down-sampled single scatter sinograms given: (i) the activity image which was reconstructed from non-scatter corrected data, (ii) the attenuation map, (iii) the attenuation map down-sampled with a factor of two, (iii) the scanner down-sampled with a factor of two in axial and transaxial directions keeping the same inner radius, (iv) the energy resolution of 20% similar to the simulation setup, (v) and the energy window of 350&#x02013;650&#x02009;keV. Then the result was up-sampled and fit to the activity image using Trispline interpolation. The down-sampling speeds up the process while it does not affect the final result significantly as the scatter distribution varies slowly with the detector pair.</p></sec><sec id="Sec12"><title>Reconstruction</title><p id="Par41">Emission data were reconstructed using fully 3D-OSEM (ordered subsets expectation maximization) algorithm [<xref ref-type="bibr" rid="CR22">22</xref>]. The number of subsets was set to six for the Scanners B and C and to five for the <italic>Scanner A</italic>. The number of subiterations was 24 for all reconstructions. STIR is able to compute the Poisson log-likelihood and its gradient on distributed computing platforms using the Message Passing Interface (MPI). We ran the reconstruction on 16 Intel cores on one compute node (2&#x02009;&#x000d7; Intel&#x000ae; Xeon&#x000ae; EP E5-2660 v2 (Ivy Bridge) at 2.2&#x02009;GHz (10 cores/socket)) from M&#x000f6;nch cluster at the Swiss National Supercomputing Centre. The compute node had 32&#x02009;GB of 1600&#x02009;MHz DDR3 RAM. The nominal frequency of the CPU was 2.2&#x02009;GHz.</p><p id="Par42">All ring differences were used in the reconstruction. The number of rays in tangential direction for raytracing each LOR was 10 for both block and cylindrical geometries. For the data from <italic>Scanners B</italic> and <italic>C</italic>, attenuation and scatter correction factors were included in the standard factorized system matrix. The data from the <italic>Scanner B</italic> were also corrected for normalization using the normalization factors calculated in the &#x0201c;<xref rid="Sec9" ref-type="sec">Normalization</xref>&#x0201d; section. The number of voxels in each direction and the voxel size for the three different scanners are summarized in Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>.</p></sec><sec id="Sec13"><title>Evaluation</title><p id="Par43">A cylindrical region of interest (ROI) was drawn so that it covered the whole uniform cylinder phantom. The coefficient of variation (COV) was calculated as the ratio of the standard deviation (STD) to the mean of this ROI, similar to NEMA NU 4 [<xref ref-type="bibr" rid="CR18">18</xref>] to evaluate the uniformity.</p><p id="Par44">Line profiles were generated along spheres with a different diameter in Derenzo phantoms. The Derenzo data taken by the <italic>Scanner B</italic> were evaluated in more details in terms of peak-to-valley (PTV) and spill-over (SOR) ratios for both cylindrical and block models. Two ROIs were drawn around each individual sphere in the Derenzo phantom. One of them was a spherical ROI as large as the sphere itself, and the other an annular ROI with the inner diameter as large as the sphere diameter and the outer diameter twice the sphere diameter (Fig.&#x000a0;<xref rid="Fig10" ref-type="fig">10</xref>). The SOR was calculated as the ratio of the mean of the annular ROI to the mean of the spherical ROI.</p><p id="Par45">The recovery coefficient (RC) as well as the percentage of its standard deviation (%STD) were calculated for the hot rods in the image quality phantom as described in NEMA NU 4 [<xref ref-type="bibr" rid="CR18">18</xref>].</p><p id="Par46">The cylindrical and block models were also evaluated in terms of time and memory consumption. For this purpose, the computations were performed on a single core of a local computer (Intel&#x000ae; Core&#x02122; i7-4710MQ CPU at 2.50&#x02009;GHz&#x02009;&#x000d7;&#x02009;8). Single forward and backward projections as well as iterative OSEM reconstruction were implemented on a data set from the <italic>Scanner B</italic> with different sizes of the system matrix. In order to create different sizes for the system matrix, maximum ring difference of the 3D sinogram was changed from 0 to 15 by steps of 5. The number of subsets and subiterations for the OSEM algorithm were six and 12, respectively. The OSEM reconstruction was run without using the MPI option and with caching the system matrix enabled. Currently, the standard cylindrical model utilized symmetries existing in the system matrix in axial and transaxial directions. The number of symmetries in the block geometry is smaller than the cylindrical geometry. Only axial symmetries have been implemented for the block model in the new version.</p></sec></sec><sec id="Sec14"><title>Results</title><sec id="Sec15"><title>The scanner with a single crystal per block&#x02014;Scanner A</title><p id="Par47">The comparison of the new implementation with the standard cylindrical implementation in STIR was performed without correcting data prior or during image reconstruction. The results from block and cylindrical model show equal reconstruction performance, however, not identical (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>). The reason is that the cylindrical model even for such a scanner design uses approximation to calculate LOR coordinates given sinogram bins. For instance, it assigns the same azimuthal angle to two tangentially adjacent LORs with slightly different azimuthal angles. The difference image in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>c illustrates this rotational difference between the images. The line profile plotted across images indicates the difference between voxel values across the line. Maximum relative difference between the images calculated over a cylindrical ROI (6&#x02009;mm&#x02009;&#x000d7;&#x02009;50&#x02009;mm &#x000d8;) was 10%.<fig id="Fig3"><label>Fig. 3</label><caption><p>Images of the Derenzo phantom simulated inside the <italic>Scanner A</italic> reconstructed using OSEM algorithm with 5&#x02009;subsets and 24 subiterations. <bold>a</bold> Cylindrical geometry, <bold>b</bold> block geometry, and <bold>c</bold> difference image as cylindrical subtracted from block. At the bottom-right, the line profiles through the sources of 1.2&#x02009;mm and 2.4&#x02009;mm diameter are plotted as well as the difference between the two line profiles. The color bar in the first row is common to both images</p></caption><graphic xlink:href="40658_2019_248_Fig3_HTML" id="MO3"/></fig></p></sec><sec id="Sec16"><title>The block-type scanner with 2.1&#x02009;&#x000d7;&#x02009;2.1&#x02009;&#x000d7;&#x02009;12&#x02009;mm<sup>3</sup> crystals&#x02014;Scanner B</title><p id="Par48">For each angular position of the plane source, we simulated about 4.175&#x02009;&#x000d7;&#x02009;10<sup>15</sup> counts in total. The maximum number of counts per sinogram bin for the block model was about 8.3&#x02009;&#x000d7;&#x02009;10<sup>3</sup> and for the cylindrical one about 2&#x02009;&#x000d7;&#x02009;10<sup>4</sup>. Figure&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref> shows direct sinograms from the plane source located perpendicular to the <italic>y</italic>-axis. Some of the bin values in the cylindrical model are always zero since no coincidence events fell into these bins. This is due to mapping the block-type scanner into a virtual cylindrical scanner. Normalization factors were calculated and histogrammed in sinogram bins. The zero bins in the measured sinograms of the cylindrical model have the highest intensity in the normalization sinograms as shown in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>c. The reason is because of the way the normalization sinograms are calculated, as inversions of the measured data. With a measured value of zero, we obtain the normalization value of infinity which is replaced in practice by a maximum value.<fig id="Fig4"><label>Fig. 4</label><caption><p>Direct sinograms in the center of the <italic>Scanner B.</italic> Rows and columns of the sinograms represent views and tangential positions, respectively. <bold>a</bold> Sinogram of the plane source located perpendicular to <italic>y</italic>-axis in cylindrical geometry, <bold>b</bold> Sinogram of the plane source located perpendicular to <italic>y</italic>-axis in block geometry, <bold>c</bold> normalization factors&#x02019; sinogram in cylindrical geometry, and <bold>d</bold> normalization factors&#x02019; sinogram in block geometry. The color bar in each row is common to both sinograms. However, for the cylindrical geometry, there are values which are more than the maximum value in the color bar. These values are depicted in white. Therefore in the sinogram (<bold>a</bold>), bins are greater than or equal to 300, and in the sinogram (<bold>c</bold>), bins greater than or equal to 0.0012 are white</p></caption><graphic xlink:href="40658_2019_248_Fig4_HTML" id="MO4"/></fig></p><p id="Par49">The reconstruction was performed using both scanner models. Figure&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>&#x02009;shows the reconstructed images of the uniform cylinder phantom. The cylindrical model creates significant artifacts prior to normalization correction while the block model yields a smooth cylinder. The COV ratio for the block model is much smaller than the one for the cylindrical model (Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>). After correcting for normalization, the block and cylindrical models show similar results. The COV ratio for the block model increases from 18.4% to 20.9%. Although, the block model is visibly more uniform than the cylindrical one after normalization. This can be inferred from the COV ratios in Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref> which shows the COV ratio for the block model is 19% better comparing to the cylindrical one, after normalization.<fig id="Fig5"><label>Fig. 5</label><caption><p>Images of the uniform cylinder phantom simulated inside the <italic>Scanner B</italic> reconstructed using OSEM algorithm with six subsets and 24 subiterations. <bold>a</bold> Cylindrical geometry without normalization, <bold>b</bold> block geometry without normalization, <bold>c</bold> cylindrical geometry with normalization, and <bold>d</bold> block geometry with normalization. The color bar in each row is common</p></caption><graphic xlink:href="40658_2019_248_Fig5_HTML" id="MO5"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption><p>The COV ratio for the uniform cylinder phantom</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Model</th><th>COV</th></tr></thead><tbody><tr><td align="center">Cylindrical without normalization</td><td align="center">33.2%</td></tr><tr><td>Block without normalization</td><td align="center">18.4%</td></tr><tr><td>Cylindrical with normalization</td><td align="center">25.8%</td></tr><tr><td>Block with normalization</td><td align="center">20.9%</td></tr></tbody></table></table-wrap></p><p id="Par50">The results for the spatial resolution test are shown in Figs.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref> and <xref rid="Fig7" ref-type="fig"><bold>7</bold></xref>. Reconstructed images of the point source together with the radial and tangential line profiles indicate that the new implementation yields a sharper image with better localization of the point source (Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>). For the point at 15&#x02009;mm, the radial and tangential line profiles of the new implementation are very close to the ones of the standard cylindrical implementation. Figure&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref> shows the full width half maximum (FWHM) in radial, tangential, and axial directions measured for the two axial positions: at the center and at one-fourth of the axial FOV. Both axial positions show a similar pattern. Radial and tangential values of FWHM are significantly larger for the cylindrical model. In a radial direction, FWHM increases by moving to the edge of the scanner which is reasonable as the point radially moves to the edge. In the axial direction, the two models show almost the same FWHM except for the point radially centered and axially located at 8.9&#x02009;mm from the center of FOV. The axial FWHMs are 1.5&#x02009;mm and 1.2&#x02009;mm, respectively, for the block and the cylindrical implementations. This could be due to the discretization artifact as for the axially centered position; the two models show similar results.<fig id="Fig6"><label>Fig. 6</label><caption><p>Images and line profiles of the point source simulated inside the <italic>Scanner B</italic> reconstructed using OSEM algorithm with six subsets and 24 subiterations. <bold>a</bold> Cylindrical geometry. <bold>b</bold> Block geometry. The top (bottom) row of line profiles is tangentially (radially) drawn across the point source. The position of the point source in the top row corresponds to those in the bottom row. The point source located at the center of the scanner moves radially till 25&#x02009;mm with steps of 5&#x02009;mm</p></caption><graphic xlink:href="40658_2019_248_Fig6_HTML" id="MO6"/></fig><fig id="Fig7"><label>Fig. 7</label><caption><p>FWHM measurements for the point simulated inside the <italic>Scanner B</italic> reconstructed using OSEM algorithm with six subsets and 24 subiterations. The point source is axially at two different positions: the center of the scanner and one-fourth of the axial FOV. For both cases, it moves radially till 25&#x02009;mm with steps of 5&#x02009;mm. The FWHM values are plotted for three axial, tangential and radial directions for the block and cylindrical models</p></caption><graphic xlink:href="40658_2019_248_Fig7_HTML" id="MO7"/></fig></p><p id="Par51">Visual comparison between the reconstructed images of the Derenzo phantom indicates a significant improvement for the block model (Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>). Smallest spheres of 1.6&#x02009;mm diameter can be clearly resolved using the new model even without applying normalization. Whereas, it is not possible to distinguish between some sources of 1.6&#x02009;mm diameter in the cylindrical model after applying normalization. A circular artifact is observed in Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>a which stays after normalization in Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>c.<fig id="Fig8"><label>Fig. 8</label><caption><p>Images of the Derenzo phantom simulated inside the <italic>Scanner B</italic> reconstructed using OSEM algorithm with six subsets and 24 subiterations. <bold>a</bold> Cylindrical geometry without normalization, <bold>b</bold> block geometry without normalization, <bold>c</bold> cylindrical geometry with normalization, and <bold>d</bold> block geometry with normalization. A circular artifact is observed in images <bold>a</bold> and <bold>c</bold>. Values on image <bold>b</bold> show the sphere diameters in millimeter</p></caption><graphic xlink:href="40658_2019_248_Fig8_HTML" id="MO8"/></fig></p><p id="Par52">Line profiles across spherical sources with different diameters are plotted in Fig.&#x000a0;<xref rid="Fig9" ref-type="fig">9</xref>. The average PTV ratio for these line profiles is higher for the block model (Fig.&#x000a0;<xref rid="Fig11" ref-type="fig">11</xref>). It is almost twice the cylindrical model, e.g., 3.63 and 2.07 for the 1.8&#x02009;mm spheres, respectively. Line profiles indicate that the PTV ratio decreases from the peripheral area to the center of the phantom. It also decreases by decreasing the source size.<fig id="Fig9"><label>Fig. 9</label><caption><p>Line profiles across images of the Derenzo phantom simulated inside the <italic>Scanner B</italic> reconstructed using OSEM algorithm with six subsets and 24 subiterations with normalization. Each graph represents a different sphere size which is written on top of the graph. A schematic of line profiles is drawn at the bottom</p></caption><graphic xlink:href="40658_2019_248_Fig9_HTML" id="MO9"/></fig></p><p id="Par53">Figure&#x000a0;<xref rid="Fig10" ref-type="fig">10</xref> indicates the mean value for spherical and annular ROIs in the Derenzo images. The values of spherical ROIs are higher for the block and those of the annular ROIs are higher for the cylindrical model. This implies a lower partial loss of intensity for the new model. The SOR of 1.8-mm spheres is 0.19 and 0.34 for the block and cylindrical geometries, respectively. This value increases by increasing the source size (Fig.&#x000a0;<xref rid="Fig11" ref-type="fig">11</xref>). There is a little kink in the SOR graph at 2.2&#x02009;mm. The reason is that the spheres of 2.2&#x02009;mm diameter are more extended to the peripheral area of the field of view where the spatial resolution degrades and the partial volume effect is more visible.<fig id="Fig10"><label>Fig. 10</label><caption><p>Mean value for spherical and annular ROIs around all sources in the Derenzo image. Each graph represents a specific sphere size which is shown on top of the graph. The spherical ROI and the annular ROI are depicted by green and yellow, respectively, in the image in the third row</p></caption><graphic xlink:href="40658_2019_248_Fig10_HTML" id="MO10"/></fig><fig id="Fig11"><label>Fig. 11</label><caption><p>SOR and PTV calculated for different source size in Derenzo phantom after normalization correction</p></caption><graphic xlink:href="40658_2019_248_Fig11_HTML" id="MO11"/></fig></p><p id="Par54">Similar to the uniform cylinder and the Derenzo phantoms, both parts of the image quality phantom show that the new model enhances the quality of the images (Fig.&#x000a0;<xref rid="Fig12" ref-type="fig">12</xref>). The part with cold rods inside the hot cylinder shows similar artifact as the uniform cylinder phantom before normalization (Fig.&#x000a0;<xref rid="Fig12" ref-type="fig">12</xref>a). After normalization, the two models visually show similar results. As for the hot rods inside the PMMA cylinder, it could be observed in Fig.&#x000a0;<xref rid="Fig12" ref-type="fig">12</xref>c that the cylindrical model tends to intensify the central region. This is because the density of the LORs in the center for the virtual cylindrical model is higher than reality. The RC values as well as their %STDs are plotted in Fig.&#x000a0;<xref rid="Fig13" ref-type="fig">13</xref> showing a higher RC and lower %STD for the block model. The RC values are especially higher for the rods of 2&#x02009;mm and 3&#x02009;mm diameters.<fig id="Fig12"><label>Fig. 12</label><caption><p>Images of the image quality phantom simulated inside the <italic>Scanner B</italic> reconstructed using OSEM algorithm with six subsets and 24 subiterations. Transverse planes through the part with the cold rods: <bold>a</bold> cylindrical geometry without normalization, <bold>b</bold> block geometry without normalization, <bold>e</bold> cylindrical geometry with normalization, and <bold>f</bold> block geometry with normalization. Transverse planes through the part with the hot rods: <bold>c</bold> cylindrical geometry without normalization, <bold>d</bold> block geometry without normalization, <bold>g</bold> cylindrical geometry with normalization, and <bold>h</bold> block geometry with normalization. The images are transverse planes through the part containing hot rods. The color bar in each row is common</p></caption><graphic xlink:href="40658_2019_248_Fig12_HTML" id="MO12"/></fig><fig id="Fig13"><label>Fig. 13</label><caption><p>RC values together with their %STD for hot rods of different diameter in the image quality phantom</p></caption><graphic xlink:href="40658_2019_248_Fig13_HTML" id="MO13"/></fig></p></sec><sec id="Sec17"><title>The block-type scanner with 1&#x02009;&#x000d7;&#x02009;1&#x02009;&#x000d7;&#x02009;10&#x02009;mm<sup>3</sup> crystals&#x02014;Scanner C</title><p id="Par55">Reconstructed images of the Derenzo phantom with spheres of 0.6&#x02009;mm diameter simulated inside the <italic>Scanner C</italic> are demonstrated in Fig.&#x000a0;<xref rid="Fig14" ref-type="fig">14</xref>. These results are without normalization correction. It can be seen that the new implementation enhances the image quality. The result from block model can resolve most spheres down to 0.8&#x02009;mm diameter without normalization correction. However, neither of two models can distinguish between the smallest spheres which are about half the crystal pitch. The line profile across spheres of 0.8&#x02009;mm and 2&#x02009;mm diameter for both models indicates that the new model is less noisy comparing to the standard cylindrical model. The goal of this measurement was only to show that the new implementation works with smaller crystal size. Therefore, we did not perform the evaluation procedure as for the <italic>Scanner B</italic>.<fig id="Fig14"><label>Fig. 14</label><caption><p>Images of the Derenzo phantom simulated inside the <italic>Scanner C</italic> reconstructed using OSEM algorithm with six subsets and 24 subiterations. <bold>a</bold> Cylindrical geometry. <bold>b</bold> Block geometry. The images are not normalized. At the top, the line profiles through the sources of 0.8&#x02009;mm and 2&#x02009;mm diameter are plotted for the two models. Values on image <bold>b</bold> show the sphere diameters in millimeter</p></caption><graphic xlink:href="40658_2019_248_Fig14_HTML" id="MO14"/></fig></p></sec><sec id="Sec18"><title>Time and memory consumption in the two models</title><p id="Par56">Figure&#x000a0;<xref rid="Fig15" ref-type="fig">15</xref> summarizes the time and memory consumption versus the size of the system matrix. The measurements have been done for the two models for different algorithms, forward and backward projection as well as OESM reconstruction. The memory usage of the three processes does not vary so much for each model. However, the block model consumes much more comparing to the cylindrical one especially by increasing the size of the system matrix. For the OSEM algorithm with six subsets and 12 subiterations, the memory usage reaches 4.5&#x02009;GB for the block model comparing to 0.25&#x02009;GB for the cylindrical model. The increase of time is less significant than the memory consumption for the block mode comparing to the cylindrical model. For the largest system matrix, the OSEM algorithm lasts about 65&#x02009;min for the block model while it is about 28&#x02009;min for the cylindrical model.<fig id="Fig15"><label>Fig. 15</label><caption><p>Time and memory consumption for different algorithms vs. the size of the system matrix for the two models. The top (bottom) row shows the memory (time) consumption. The first, second, and third columns represent the forward projection, backward projection, and OSEM algorithm with six subsets and 12 subiterations. Each plot consists of four different sizes of the system matrix which correspond to different maximum ring differences of 0, 5, 10, and 15</p></caption><graphic xlink:href="40658_2019_248_Fig15_HTML" id="MO15"/></fig></p></sec></sec><sec id="Sec19"><title>Discussion</title><p id="Par57">A precise scanner model is essential to build a precise system matrix in the PET reconstruction. Simplified assumptions could cause wrong LOR coordinates and therefore wrong positioning of the source distribution. The effect of remapping the scanner into a virtual cylindrical scanner varies for different scanner geometries. When STIR operates in the cylindrical mode, it maps the block-type scanner on a cylinder with the same inner radius. This means LOR coordinates in the cylindrical mode are slightly different compared to the block mode. For a given LOR&#x02014;described with azimuthal angle, polar angle, axial position, and tangential position&#x02014;STIR tries to find the corresponding sinogram bin. Since detector positions in the cylindrical mode are rearranged for a block-type scanner, LORs could be assigned to wrong bins. Some bins might be chosen more often than in the correct geometry and some bins might be never chosen (zero bins in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>a). Consequently, also the maximum number of counts per sinogram bin is different for the two models. This could be especially observed in the results for the rotating plane source which has a high statistics (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>).</p><p id="Par58">Using the more accurate block model, we expect to get smoother sinograms for the plane source (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>b), however, still not perfectly smooth. A slight non-uniformity is observed close to the edges of the detector blocks in the sinogram of the block model. This effect is well pronounced in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>d in the normalization sinogram which is the result of the superposition of the measured sinograms followed by an inversion. This slight non-uniformity, unlike the severe non-uniformity in the cylindrical model, is because of the crystal interference effect within a block. It is a pattern that is repeated for the detectors in every block [<xref ref-type="bibr" rid="CR19">19</xref>].</p><p id="Par59">The normalization corrects the non-uniformity caused by geometric effects and the non-uniformity of detector responses. The latter does not exist in our simulations, and since the new implementation in STIR can more accurately model the block-type scanner, the non-uniformity in the sinogram and consequently in the image is reduced. Figure&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>b indicates that the block model produces a uniform cylinder even before normalization. However, there is a small residual of non-uniformity that could be observed in the middle of the cylinder which disappear after normalization (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>d).</p><p id="Par60">On the other hand, the result of COV indicates that applying normalization correction introduces a noise into the image reconstructed by the block model. The reason is the limited statistics per LOR. Equation (<xref rid="Equ1" ref-type="">1</xref>) shows that the uncertainty of a given voxel value increases corresponding to the number of bins contributing in calculation of that voxel, as well as the uncertainty of the normalization factors (3.2%). By increasing the statistics, the uncertainty in normalization factors decreases, and therefore, the noise introduced by normalization decreases. As an alternative, component-based methods could be used to find normalization factors with lower statistics. To investigate the effect of statistics on the image uniformity, we calculated the normalization factors with one-tenth of the current statistics. The reconstructed images using these normalization factors are much noisier. The COV for the lower statistics case is 42.8% compared to 20.9% calculated for the higher statistics case.</p><p id="Par61">In the Monte Carlo simulation, we did not simulate the non-uniformity of the detector responses, which in reality can add to the image noise. This means, in the real scanner, the proper normalization is essential to improve the uniformity even in the case of block implementation. Additional studies can be performed to assess the block model with real data acquired from different scanner designs such as the SAFIR scanner.</p><p id="Par62">As for the spatial resolution, the simulation results show that the new model improves the images compared to the standard cylindrical model. The line profiles across the point sources show that in the transaxial plane, the spatial source distribution is much sharper for the block model, while in the axial direction, the two models give similar results. The reason is that the difference between the two models in the axial direction is only a gap between the two detector blocks while in the transaxial plane, the difference is more significant because all detector elements are slightly dispositioned for the cylindrical model.</p><p id="Par63">The results from Derenzo phantom (Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>) show that although normalization can improve the quality of the image for the cylindrical implementation, it still leaves artifacts in the reconstructed image. The normalized Derenzo image reconstructed with the cylindrical model in Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>c shows a circular artifact.</p><p id="Par64">In the Derenzo phantom, it may look like the image intensity is higher in the center of the phantom, but this is not the case, because the average intensity stays the same across larger regions in the phantom. This can be inferred from the line profiles where the peak values decrease to the peripheral area but the valley values increase. This is due to the spill-over effect that is caused by degraded spatial resolution in the peripheral area. The SOR ratio is another evidence for this effect since it increases at the center of the phantom.</p><p id="Par65">RC values calculated for the image quality phantom show that the block model can better recover the intensity for the rods of 2&#x02009;mm and 3&#x02009;mm diameter. The block model decreases the partial volume effect and enhances the image contrast where the source size is close to the size of detector elements. For larger rods, the two models give similar results. The RC value for the smallest rod is not reliable due to the high %STD which is 90% and 140%, respectively, for the block and cylindrical model. The 1-mm rod is out of the resolution of the <italic>Scanner B</italic>.</p><p id="Par66">The use of more accurate block geometry is computationally more intensive as the number of symmetries in the block geometry is smaller than the cylindrical geometry. This means that more calculations are required for the system matrix elements in each forward/backward projection in the iterative reconstruction (Fig.&#x000a0;<xref rid="Fig15" ref-type="fig">15</xref>). In the new implementation, the block geometry only utilizes symmetries in an axial direction. It would be useful to also implement symmetries in the transaxial direction to accelerate the computation.</p><p id="Par67">Since the implementation of block geometry in the STIR library was based on calculating LOR parameters directly from the Cartesian coordinates of detection points, this opens a door to extend the library to more generic geometries, i.e., to any arrangement of the so-called cylindrical PET scanners such that there is no limitation in the size and number of crystals, blocks of crystals, and modules of blocks as long as they stay in a ringed-shape geometry.</p></sec><sec id="Sec20"><title>Conclusion</title><p id="Par68">We implemented a more accurate scanner model for PET image reconstruction in the STIR library. Scanner geometries with the shape of a regular polygon can be modeled using the new implementation. The new implementation was tested and is available for use via the ETH library [<xref ref-type="bibr" rid="CR23">23</xref>]. The new model was evaluated in terms of spatial resolution, partial volume effect, and uniformity using Monte Carlo simulation of the Derenzo and a uniform cylinder phantom. Results indicate a significant improvement for the new model in comparison with the old one which re-sampled the data from a physical polygonal geometry into a virtual cylindrical scanner geometry.</p></sec><sec id="Sec21"><title>List of parameters</title><p id="Par69"><bold><italic>f</italic></bold> (vector): the function of the radiotracer&#x02019;s distribution</p><p id="Par70"><italic>L</italic> (diagonal matrices): attenuation correction factors</p><p id="Par71"><italic>N</italic> (diagonal matrices): normalization correction factors</p><p id="Par72"><bold><italic>q</italic></bold> (vector): the mean of the measured data</p><p id="Par73"><bold><italic>r</italic></bold> (vector): estimate of the mean random events</p><p id="Par74"><bold><italic>s</italic></bold> (vector): estimate of the mean of scatter events</p><p id="Par75"><italic>X</italic> (matrix): the geometric model that relates the projection space to the image space</p></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>COV</term><def><p id="Par4">Coefficient of variation</p></def></def-item><def-item><term>ETH</term><def><p id="Par5">Swiss Federal Institute of Technology in Zurich</p></def></def-item><def-item><term>FOV</term><def><p id="Par6">Field of view</p></def></def-item><def-item><term>FWHM</term><def><p id="Par7">Full width half maximum</p></def></def-item><def-item><term>LOR</term><def><p id="Par8">Line of response</p></def></def-item><def-item><term>MPI</term><def><p id="Par9">Message Passing Interface</p></def></def-item><def-item><term>MRI</term><def><p id="Par10">Magnetic resonance imaging</p></def></def-item><def-item><term>PET</term><def><p id="Par11">Positron-emission tomography</p></def></def-item><def-item><term>PTV</term><def><p id="Par12">Peak-to-valley</p></def></def-item><def-item><term>RC</term><def><p id="Par13">Recovery coefficient</p></def></def-item><def-item><term>ROI</term><def><p id="Par14">Region of interest</p></def></def-item><def-item><term>SAFIR</term><def><p id="Par15">Small Animal Fast Insert for MRI</p></def></def-item><def-item><term>SOR</term><def><p id="Par16">Spill-over ratio</p></def></def-item><def-item><term>STIR</term><def><p id="Par17">Software for Tomographic Image Reconstruction</p></def></def-item></def-list></glossary><fn-group><fn><p><bold>Publisher&#x02019;s Note</bold></p><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><ack><title>Acknowledgement</title><p>We would like to thank Kris Thielemans from Institute of Nuclear Medicine, University College London who provided valuable advice in the early stages of this work.</p><p>We are also grateful to Alexander Howard for the provision of the simulated data described in the &#x0201c;<xref rid="Sec5" ref-type="sec">The scanner with a single crystal per block&#x02014;Scanner A</xref>&#x0201d; section.</p><p>We acknowledge Christian Edwin Ritzer and Oliver Grimm for their critical review of the manuscript.</p></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>PK performed the experiments, developed the reconstruction software, built and ran the simulations, performed reconstructions and data analysis, and drafted the manuscript. JF initially provided ideas on code structure and implementation within STIR and created the coincidence sorter tool in the analysis chain. WL and CT were involved in the design of this study and provided advice on the development of the source code and various methodological approaches of the investigation. GD was involved in the organization and planning of the work and discussions on the results. All authors critically reviewed the manuscript. All authors read and approved the final manuscript. The author list is alphabetically ordered, except for the first and the last authors.</p></notes><notes notes-type="funding-information"><title>Funding</title><p>This work was supported by the ETH Zurich Foundation through Research Grant ETH-30 14-2. Charalampos Tsoumpas was supported by a Royal Society Industry Fellowship (IF170011).</p></notes><notes notes-type="data-availability"><title>Availability of data and materials</title><p>The new implementation for image reconstruction and details of software implementation and installation are available: 10.5905/ethz-1007-146.</p><p>Simulated data cannot be provided, but the simulation procedure&#x02014;phantoms and scanner geometry&#x02014;has been described in the &#x0201c;<xref rid="Sec4" ref-type="sec">Monte Carlo simulations</xref>&#x0201d; section. Simulated data of any scanner, representable by the above-described block-type implementation in STIR, can be used to replicate the results and validate the findings, namely demonstrate the improved image quality, due to the proper representation of the scanner geometry.</p></notes><notes><title>Ethics approval and consent to participate</title><p id="Par76">Not applicable.</p></notes><notes><title>Consent for publication</title><p id="Par77">Not applicable.</p></notes><notes notes-type="COI-statement"><title>Competing interests</title><p id="Par78">The authors declare that they have no competing interests.</p></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lange</surname><given-names>K</given-names></name><name><surname>Carson</surname><given-names>R</given-names></name></person-group><article-title>EM reconstruction algorithms for emission and transmission tomography</article-title><source>J Comput Assist Tomogr</source><year>1984</year><volume>8</volume><issue>2</issue><fpage>306</fpage><lpage>316</lpage><?supplied-pmid 6608535?><pub-id pub-id-type="pmid">6608535</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carson</surname><given-names>RE</given-names></name><name><surname>Yan</surname><given-names>Y</given-names></name><name><surname>Chodkowski</surname><given-names>B</given-names></name><name><surname>Yap</surname><given-names>TK</given-names></name><name><surname>Daube-Witherspoon</surname><given-names>ME</given-names></name></person-group><article-title>Precision and accuracy of regional radioactivity quantitation using the maximum likelihood EM reconstruction algorithm</article-title><source>IEEE transactions on medical imaging</source><year>1994</year><volume>13</volume><issue>3</issue><fpage>526</fpage><lpage>537</lpage><pub-id pub-id-type="doi">10.1109/42.310884</pub-id><pub-id pub-id-type="pmid">18218528</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mumcuoglu</surname><given-names>EU</given-names></name><name><surname>Leahy</surname><given-names>R</given-names></name><name><surname>Cherry</surname><given-names>SR</given-names></name><name><surname>Zhou</surname><given-names>Z</given-names></name></person-group><article-title>Fast gradient-based methods for Bayesian reconstruction of transmission and emission PET images</article-title><source>IEEE transactions on Medical Imaging</source><year>1994</year><volume>13</volume><issue>4</issue><fpage>687</fpage><lpage>701</lpage><pub-id pub-id-type="doi">10.1109/42.363099</pub-id><pub-id pub-id-type="pmid">18218547</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qi</surname><given-names>J</given-names></name><name><surname>Leahy</surname><given-names>RM</given-names></name><name><surname>Cherry</surname><given-names>SR</given-names></name><name><surname>Chatziioannou</surname><given-names>A</given-names></name><name><surname>Farquhar</surname><given-names>TH</given-names></name></person-group><article-title>High-resolution 3D Bayesian image reconstruction using the microPET small-animal scanner</article-title><source>Physics in medicine &#x00026; biology</source><year>1998</year><volume>43</volume><issue>4</issue><fpage>1001</fpage><pub-id pub-id-type="doi">10.1088/0031-9155/43/4/027</pub-id><pub-id pub-id-type="pmid">9572523</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Panin</surname><given-names>V</given-names></name><name><surname>Kehren</surname><given-names>F</given-names></name><name><surname>Rothfuss</surname><given-names>H</given-names></name><name><surname>Hu</surname><given-names>D</given-names></name><name><surname>Michel</surname><given-names>C</given-names></name><name><surname>Casey</surname><given-names>M</given-names></name></person-group><article-title>PET reconstruction with system matrix derived from point source measurements</article-title><source>IEEE transactions on nuclear science</source><year>2006</year><volume>53</volume><issue>1</issue><fpage>152</fpage><lpage>159</lpage><pub-id pub-id-type="doi">10.1109/TNS.2005.862979</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rafecas</surname><given-names>M.</given-names></name><name><surname>Mosler</surname><given-names>B.</given-names></name><name><surname>Dietz</surname><given-names>M.</given-names></name><name><surname>Pogl</surname><given-names>M.</given-names></name><name><surname>Stamatakis</surname><given-names>A.</given-names></name><name><surname>McElroy</surname><given-names>D.P.</given-names></name><name><surname>Ziegler</surname><given-names>S.I.</given-names></name></person-group><article-title>Use of a Monte Carlo-based probability matrix for 3-D iterative reconstruction of MADPET-II data</article-title><source>IEEE Transactions on Nuclear Science</source><year>2004</year><volume>51</volume><issue>5</issue><fpage>2597</fpage><lpage>2605</lpage><pub-id pub-id-type="doi">10.1109/TNS.2004.834827</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aguiar</surname><given-names>Pablo</given-names></name><name><surname>Rafecas</surname><given-names>Magdalena</given-names></name><name><surname>Ortu&#x000f1;o</surname><given-names>Juan Enrique</given-names></name><name><surname>Kontaxakis</surname><given-names>George</given-names></name><name><surname>Santos</surname><given-names>Andr&#x000e9;s</given-names></name><name><surname>Pav&#x000ed;a</surname><given-names>Javier</given-names></name><name><surname>Ros</surname><given-names>Dom&#x000e8;nec</given-names></name></person-group><article-title>Geometrical and Monte Carlo projectors in 3D PET reconstruction</article-title><source>Medical Physics</source><year>2010</year><volume>37</volume><issue>11</issue><fpage>5691</fpage><lpage>5702</lpage><pub-id pub-id-type="doi">10.1118/1.3501884</pub-id><pub-id pub-id-type="pmid">21158281</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joseph</surname><given-names>PM</given-names></name></person-group><article-title>An improved algorithm for reprojecting rays through pixel images</article-title><source>IEEE transactions on medical imaging</source><year>1982</year><volume>1</volume><issue>3</issue><fpage>192</fpage><lpage>196</lpage><pub-id pub-id-type="doi">10.1109/TMI.1982.4307572</pub-id><pub-id pub-id-type="pmid">18238275</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reader</surname><given-names>AJ</given-names></name><name><surname>Zaidi</surname><given-names>H</given-names></name></person-group><article-title>Advances in PET image reconstruction</article-title><source>PET clinics</source><year>2007</year><volume>2</volume><issue>2</issue><fpage>173</fpage><lpage>190</lpage><pub-id pub-id-type="doi">10.1016/j.cpet.2007.08.001</pub-id><pub-id pub-id-type="pmid">27157872</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sureau</surname><given-names>F. C.</given-names></name><name><surname>Reader</surname><given-names>A. J.</given-names></name><name><surname>Comtat</surname><given-names>C.</given-names></name><name><surname>Leroy</surname><given-names>C.</given-names></name><name><surname>Ribeiro</surname><given-names>M.-J.</given-names></name><name><surname>Buvat</surname><given-names>I.</given-names></name><name><surname>Trebossen</surname><given-names>R.</given-names></name></person-group><article-title>Impact of Image-Space Resolution Modeling for Studies with the High-Resolution Research Tomograph</article-title><source>Journal of Nuclear Medicine</source><year>2008</year><volume>49</volume><issue>6</issue><fpage>1000</fpage><lpage>1008</lpage><pub-id pub-id-type="doi">10.2967/jnumed.107.045351</pub-id><pub-id pub-id-type="pmid">18511844</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shepp</surname><given-names>LA</given-names></name><name><surname>Vardi</surname><given-names>Y</given-names></name></person-group><article-title>Maximum likelihood reconstruction for emission tomography</article-title><source>IEEE transactions on medical imaging</source><year>1982</year><volume>1</volume><issue>2</issue><fpage>113</fpage><lpage>122</lpage><pub-id pub-id-type="doi">10.1109/TMI.1982.4307558</pub-id><pub-id pub-id-type="pmid">18238264</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thielemans</surname><given-names>Kris</given-names></name><name><surname>Tsoumpas</surname><given-names>Charalampos</given-names></name><name><surname>Mustafovic</surname><given-names>Sanida</given-names></name><name><surname>Beisel</surname><given-names>Tobias</given-names></name><name><surname>Aguiar</surname><given-names>Pablo</given-names></name><name><surname>Dikaios</surname><given-names>Nikolaos</given-names></name><name><surname>Jacobson</surname><given-names>Matthew W</given-names></name></person-group><article-title>STIR: software for tomographic image reconstruction release 2</article-title><source>Physics in Medicine and Biology</source><year>2012</year><volume>57</volume><issue>4</issue><fpage>867</fpage><lpage>883</lpage><pub-id pub-id-type="doi">10.1088/0031-9155/57/4/867</pub-id><pub-id pub-id-type="pmid">22290410</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Siddon</surname><given-names>RL</given-names></name></person-group><article-title>Fast calculation of the exact radiological path for a three-dimensional CT array</article-title><source>Medical physics</source><year>1985</year><volume>12</volume><issue>2</issue><fpage>252</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1118/1.595715</pub-id><pub-id pub-id-type="pmid">4000088</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="other">Fischer J. SAFIR input file format for STIR [Online]. Available: 10.5905/ethz-1007-22.</mixed-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allison</surname><given-names>J</given-names></name><etal/></person-group><article-title>Geant4 developments and applications</article-title><source>IEEE Transactions on nuclear science</source><year>2006</year><volume>53</volume><issue>1</issue><fpage>270</fpage><lpage>278</lpage><pub-id pub-id-type="doi">10.1109/TNS.2006.869826</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jan</surname><given-names>S</given-names></name><etal/></person-group><article-title>GATE: a simulation toolkit for PET and SPECT</article-title><source>Physics in Medicine &#x00026; Biology</source><year>2004</year><volume>49</volume><issue>19</issue><fpage>4543</fpage><pub-id pub-id-type="doi">10.1088/0031-9155/49/19/007</pub-id><pub-id pub-id-type="pmid">15552416</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Becker</surname><given-names>Robert</given-names></name><name><surname>Buck</surname><given-names>Alfred</given-names></name><name><surname>Casella</surname><given-names>Chiara</given-names></name><name><surname>Dissertori</surname><given-names>G&#x000fc;nther</given-names></name><name><surname>Fischer</surname><given-names>Jannis</given-names></name><name><surname>Howard</surname><given-names>Alexander</given-names></name><name><surname>Ito</surname><given-names>Mikiko</given-names></name><name><surname>Khateri</surname><given-names>Parisa</given-names></name><name><surname>Lustermann</surname><given-names>Werner</given-names></name><name><surname>Oliver</surname><given-names>Josep F.</given-names></name><name><surname>R&#x000f6;ser</surname><given-names>Ulf</given-names></name><name><surname>Warnock</surname><given-names>Geoffrey</given-names></name><name><surname>Weber</surname><given-names>Bruno</given-names></name></person-group><article-title>The SAFIR experiment: Concept, status and perspectives</article-title><source>Nuclear Instruments and Methods in Physics Research Section A: Accelerators, Spectrometers, Detectors and Associated Equipment</source><year>2017</year><volume>845</volume><fpage>648</fpage><lpage>651</lpage><pub-id pub-id-type="doi">10.1016/j.nima.2016.05.037</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="other">N. E. M. Association. Performance measurements of small animal positron emission tomographs. <italic>NEMA Standards Publication, NU4-2008</italic>. 2008:1&#x02013;23.</mixed-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bailey</surname><given-names>DL</given-names></name><name><surname>Townsend</surname><given-names>DW</given-names></name><name><surname>Kinahan</surname><given-names>PE</given-names></name><name><surname>Grootoonk</surname><given-names>S</given-names></name><name><surname>Jones</surname><given-names>T</given-names></name></person-group><article-title>An investigation of factors affecting detector and geometric correction in normalization of 3-D PET data</article-title><source>IEEE Transactions on Nuclear Science</source><year>1996</year><volume>43</volume><issue>6</issue><fpage>3300</fpage><lpage>3307</lpage><pub-id pub-id-type="doi">10.1109/23.552739</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="other">Hubbell&#x000a0;JH, Seltzer SM. Tables of X-ray mass attenuation coefficients and mass energy-absorption coefficients 1 keV to 20 MeV for elements Z= 1 to 92 and 48 additional substances of dosimetric interest, National Inst. of Standards and Technology-PL, Gaithersburg, MD (United States). Ionizing Radiation Div. 1995.</mixed-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsoumpas</surname><given-names>C</given-names></name><name><surname>Aguiar</surname><given-names>P</given-names></name><name><surname>Nikita</surname><given-names>K</given-names></name><name><surname>Ros</surname><given-names>D</given-names></name><name><surname>Thielemans</surname><given-names>K</given-names></name></person-group><article-title>Evaluation of the single scatter simulation algorithm implemented in the STIR library</article-title><source>IEEE Symposium Conference Record Nuclear Science 2004</source><year>2004</year><volume>6</volume><fpage>3361</fpage><lpage>3365</lpage><pub-id pub-id-type="doi">10.1109/NSSMIC.2004.1466455</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hudson</surname><given-names>HM</given-names></name><name><surname>Larkin</surname><given-names>RS</given-names></name></person-group><article-title>Accelerated image reconstruction using ordered subsets of projection data</article-title><source>IEEE transactions on medical imaging</source><year>1994</year><volume>13</volume><issue>4</issue><fpage>601</fpage><lpage>609</lpage><pub-id pub-id-type="doi">10.1109/42.363108</pub-id><pub-id pub-id-type="pmid">18218538</pub-id></element-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="other">Khateri P. Block geometry in STIR [Online]. Available: 10.5905/ethz-1007-146.</mixed-citation></ref></ref-list></back></article>