<?xml version="1.0" encoding="UTF-8"?>
<p id="Par11">The 3D NPC can provide an additional reciprocal vector along the propagation direction of the fundamental beam to achieve full QPM for nonlinear beam shaping. From Eq. (
 <xref rid="Equ2" ref-type="">2</xref>), the 3D 
 <italic>χ</italic>
 <sup>(2)</sup> distribution for SH vortex beam generation can be expressed as
 <disp-formula id="Equ5">
  <label>5</label>
  <alternatives>
   <tex-math id="M15">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\begin{array}{*{20}{l}} {\chi ^{\left( 2 \right)}\left( {x,y,z} \right)} \hfill &amp; = \hfill &amp; {d_{33} - d_{33}\left( {1 - v} \right)T\left[ {\cos \left( {G_xx - \varphi } \right)} \right] \times T\left[ {\cos \left( {G_yy} \right)} \right]} \hfill \\ {} \hfill &amp; = \hfill &amp; {d_{33} - d_{33}\left( {1 - v} \right)\mathop {\sum}\nolimits_{m,n} {c_{m,n}e^{i\left( {mG_xx + nG_yy} \right)}e^{ - im\varphi }} .} \hfill \end{array}$$\end{document}</tex-math>
   <math id="M16">
    <mtable>
     <mtr>
      <mtd columnalign="left">
       <msup>
        <mrow>
         <mi>χ</mi>
        </mrow>
        <mrow>
         <mfenced close=")" open="(" separators="">
          <mrow>
           <mn>2</mn>
          </mrow>
         </mfenced>
        </mrow>
       </msup>
       <mfenced close=")" open="(" separators="">
        <mrow>
         <mi>x</mi>
         <mo>,</mo>
         <mi>y</mi>
         <mo>,</mo>
         <mi>z</mi>
        </mrow>
       </mfenced>
      </mtd>
      <mtd columnalign="left">
       <mo>=</mo>
      </mtd>
      <mtd columnalign="left">
       <msub>
        <mrow>
         <mi>d</mi>
        </mrow>
        <mrow>
         <mn>33</mn>
        </mrow>
       </msub>
       <mo>−</mo>
       <msub>
        <mrow>
         <mi>d</mi>
        </mrow>
        <mrow>
         <mn>33</mn>
        </mrow>
       </msub>
       <mfenced close=")" open="(" separators="">
        <mrow>
         <mn>1</mn>
         <mo>−</mo>
         <mi>v</mi>
        </mrow>
       </mfenced>
       <mi>T</mi>
       <mfenced close="]" open="[" separators="">
        <mrow>
         <mi>cos</mi>
         <mfenced close=")" open="(" separators="">
          <mrow>
           <msub>
            <mrow>
             <mi>G</mi>
            </mrow>
            <mrow>
             <mi>x</mi>
            </mrow>
           </msub>
           <mi>x</mi>
           <mo>−</mo>
           <mi>φ</mi>
          </mrow>
         </mfenced>
        </mrow>
       </mfenced>
       <mo>×</mo>
       <mi>T</mi>
       <mfenced close="]" open="[" separators="">
        <mrow>
         <mi>cos</mi>
         <mfenced close=")" open="(" separators="">
          <mrow>
           <msub>
            <mrow>
             <mi>G</mi>
            </mrow>
            <mrow>
             <mi>y</mi>
            </mrow>
           </msub>
           <mi>y</mi>
          </mrow>
         </mfenced>
        </mrow>
       </mfenced>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left"/>
      <mtd columnalign="left">
       <mo>=</mo>
      </mtd>
      <mtd columnalign="left">
       <msub>
        <mrow>
         <mi>d</mi>
        </mrow>
        <mrow>
         <mn>33</mn>
        </mrow>
       </msub>
       <mo>−</mo>
       <msub>
        <mrow>
         <mi>d</mi>
        </mrow>
        <mrow>
         <mn>33</mn>
        </mrow>
       </msub>
       <mfenced close=")" open="(" separators="">
        <mrow>
         <mn>1</mn>
         <mo>−</mo>
         <mi>v</mi>
        </mrow>
       </mfenced>
       <msub>
        <mrow>
         <mo>∑</mo>
        </mrow>
        <mrow>
         <mi>m</mi>
         <mo>,</mo>
         <mi>n</mi>
        </mrow>
       </msub>
       <msub>
        <mrow>
         <mi>c</mi>
        </mrow>
        <mrow>
         <mi>m</mi>
         <mo>,</mo>
         <mi>n</mi>
        </mrow>
       </msub>
       <msup>
        <mrow>
         <mi>e</mi>
        </mrow>
        <mrow>
         <mi>i</mi>
         <mfenced close=")" open="(" separators="">
          <mrow>
           <mi>m</mi>
           <msub>
            <mrow>
             <mi>G</mi>
            </mrow>
            <mrow>
             <mi>x</mi>
            </mrow>
           </msub>
           <mi>x</mi>
           <mo>+</mo>
           <mi>n</mi>
           <msub>
            <mrow>
             <mi>G</mi>
            </mrow>
            <mrow>
             <mi>y</mi>
            </mrow>
           </msub>
           <mi>y</mi>
          </mrow>
         </mfenced>
        </mrow>
       </msup>
       <msup>
        <mrow>
         <mi>e</mi>
        </mrow>
        <mrow>
         <mo>−</mo>
         <mi>i</mi>
         <mi>m</mi>
         <mi>φ</mi>
        </mrow>
       </msup>
       <mo>.</mo>
      </mtd>
     </mtr>
    </mtable>
   </math>
   <graphic xlink:href="41467_2019_12251_Article_Equ5.gif" position="anchor" xmlns:xlink="http://www.w3.org/1999/xlink"/>
  </alternatives>
 </disp-formula>
</p>
