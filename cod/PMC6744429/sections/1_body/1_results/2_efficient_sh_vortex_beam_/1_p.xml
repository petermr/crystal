<?xml version="1.0" encoding="UTF-8"?>
<p id="Par13">The 3D fork-grating NPC (Fig. 
 <xref rid="Fig1" ref-type="fig">1b</xref>) fabricated by the femtosecond-laser-erasing technique (see “Methods” section for details) has dimensions of 45 μm (
 <italic>x</italic>) × 45 μm (
 <italic>y</italic>) × 45 μm (
 <italic>z</italic>). Figure 
 <xref rid="Fig2" ref-type="fig">2a</xref> shows the SH microscopy images
 <sup>
  <xref ref-type="bibr" rid="CR45">45</xref>
 </sup> of the 3D NPC. The nonlinear structure in the 
 <italic>x–z</italic> plane presents a forkgrating carrying a TC of 
 <italic>l</italic> = 1, while the 
 <italic>x–y</italic> plane shows a 2D periodical array. A fundamental beam generated by a Ti:sappire femtosecond laser (80 MHz repetition rate; 75 fs pulse width) with a tunable wavelength from 690 nm to 1050 nm is used to realize 3D nonlinear beam shaping. It polarizes along the 
 <italic>z</italic>-axis and propagates along the 
 <italic>y</italic>-axis of the crystal. Figure 
 <xref rid="Fig2" ref-type="fig">2b–d</xref> show the generated SH diffraction patterns under different input pump wavelengths. The ± 1st, ±2nd, and ±3rd diffraction orders of SH vortex beams are phase matched at 820 nm, 802 nm, and 781 nm, corresponding to the vortex beams carrying TCs of 
 <italic>l</italic> = ±1, ±2, and ±3, respectively. See Supplementary Note 
 <xref rid="MOESM1" ref-type="media">3</xref> and Supplementary Fig. 
 <xref rid="MOESM1" ref-type="media">1</xref> for the measurements of TCs. For example, when the input wavelength is 820 nm, the ±1st nonlinear diffraction orders of vortex beams are significantly enhanced with the assistance of the reciprocal vector ±
 <bold>G</bold>
 <sub>
  <italic>x</italic>
 </sub> + 
 <bold>G</bold>
 <sub>
  <italic>y</italic>
 </sub>, distinguishing itself from the traditional nonlinear Raman-Nath diffraction. Similarly, the ±2nd and ±3rd orders of vortex beams (Fig. 
 <xref rid="Fig2" ref-type="fig">2c, d</xref>) are phase matched by the reciprocal vectors ±2
 <bold>G</bold>
 <sub>
  <italic>x</italic>
 </sub> + 
 <bold>G</bold>
 <sub>
  <italic>y</italic>
 </sub> and ±
 <italic>3</italic>
 <bold>G</bold>
 <sub>
  <italic>x</italic>
 </sub> + 
 <bold>G</bold>
 <sub>
  <italic>y</italic>
 </sub>, respectively. Obviously, the introduction of the longitudinal reciprocal vector component 
 <bold>G</bold>
 <sub>
  <italic>y</italic>
 </sub> in the propagation direction is the key to achieve desired efficient nonlinear beam shaping.
</p>
