<html xmlns="http://www.w3.org/1999/xhtml"><head> <style type="text/css">
         	     		 
         	    a                          {background : #ffffff; }
         	    article                    {border-style : dotted; border-width : 2px; }
         		 	
         		 	div                        {background : #ffffcc;}
         		 	div.abstract-title         {font-weight : bold ; font-size : 16pt;}
         		 	div.ack                    {border-style : solid ; border-color : red; margin
         : 2em; }
         		 	div.article-meta           {border-style : solid; border-width : 1 pt; margin
         1em;}
         		 	div.boxed-text             {margin : 5em; border-style : solid;}
         		 	div.contrib-group          {margin : 1em; }
         		 	div.fig                    {border-style : solid; border-width : 2px; margin :
         2em; }
         		 	div.funding                {font-weight : bold ; font-size : 16pt;}
         		 	div.given-names            {font-style : italic;}
         		 	div.intro                  {border-style : inset; margin : 5px;}
         		 	div.introduction           {border-style : inset; margin : 5px;}
         		 	div.journal-meta           {border-style : solid; border-width : 1 pt; margin
         1em;}
         		 	div.journal-title-group    {background : #ffeeee;}
         		 	div.article-title          {font-weight : bold ; font-size : 18pt;}
         		 	div.kwd                    {font-style : italic}
         		 	div.meta-name              {font-weight : bold ; font-size : 16pt;}
         		 	div.name                   {font-weight : bold;}
         		 	div.alt-title              {font-style : italic; font-size : 12px;}
         		 	
         		 	div.sec                    {border : 2px; margin 5px; padding 2px;}
         		 	div.title                  {font-family : courier; font-weight : bold;
         		 	                            font-size : 16pt; margin : 5px;}
         		 	
         		 	div.materials_methods      {border-style : double; margin : 5px; }
         		 	div.methods                {border-style : double; margin : 5px; }
         		 	
         		 	div.results                {border-style : solid; margin : 5px;}
         		 	div.background             {border-style : dotted; margin : 5px;}
         		 	
         		 	div.discussion             {border-style : groove; margin : 5px;}
         		 	div.conclusion             {border-style : ridge; margin : 5px;}
         		 	div.conclusions             {border-style : ridge; margin : 5px;}
         		 	div.supplementary-material {border-style : inset; margin : 5px;}
         		 	div.abbreviations          {border-style : double; border-color : red; margin
         : 5px;}
         		 	div.competinginterests     {border-style : double; border-color : blue; margin
         : 5px;}
         		 	div.acknowledgements       {border-style : double; border-color : green; margin
         : 5px;}
         		 	div.authors_contributions   {border-style : double; border-color : purple; margin
         : 5px;}
         		 	
         		 	div.publisher              {border-style : outset; margin : 5px;}
         		 	div.fn-type-conflict       {background : #f88; }
         		 	div.fn-type-con            {background : #ddf; }
         		 	div.fn-type-other          {background : #ddd; }
         		 	
         		 	div.unknown                {background : #ffd;
         									 	  border-style : solid;
         									 	  border-width : 1px;
         									 	  padding : 2 px;}
         		 	  
         	    table                      {background : #ffffdd;}
         		 	tr                         {background : #ddddff; padding : 1px;}
         		 	
         		 	span                       {background : #ffcccc;}
         		 	
         		 	span.citation-author       {font-family : helvetica; background : #ffeeee;}
         		 	span.collab                {background : #ddffff; }
         		 	span.comment               {font-family : courier; font-size : 6px; background
         : #ffaaff;}
         		 	span.contrib               {background : #ffffff;}
         		 	span.corresp               {background : #ddffdd; }
         		 	span.doi                   {background : #ffffff;}
         		 	span.email                 {font-family : courier; }
         		 	span.etal                  {font-style : italic;}
         		 	span.fpage                 {font-family : courier;}
         		 	span.given-names           {background : #ffffff;}
         		 	span.iso-abbrev            {background : #ffffff;}
         		 	span.issn-epub             {background : #ffffff;}
         		 	span.issn-ppub             {background : #ffffff;}
         		 	span.journal-title         {background : #ffffff;}
         		 	span.lpage                 {font-family : courier;}
         		 	span.mixed-article-title   {font-style : italic ;}
         		 	span.nlm-ta                {background : #ffffff;}
         		 	span.pmc                   {background : #ffffff;}
         		 	span.pmcid                 {background : #ffffff;}
         		 	span.pmid                  {background : #ffffff;}
         		 	span.publisher             {background : #ffffff;}
         		 	span.publisher-id          {background : #ffffff;}
         		 	span.publisher-name        {background : #ffffff;}
         		 	span.source                {background : #ffffff;}
         		 	span.subject               {background : #ffffff;}
         		 	span.surname               {background : #ffffff;}
         		 	span.volume                {font-family : courier; font-weight : bold;}
         		 	span.year                  {font-family : courier ; font-style : italic;}
         			
      </style> </head> <body> <div class="front" title="front"> <div class="journal-meta" tagx="journal-meta" title="journal-meta"> <span class="nlm-ta" title="nlm-ta">EJNMMI Phys</span> <span class="iso-abbrev" title="iso-abbrev">EJNMMI Phys</span> <div class="journal-title-group" tagx="journal-title-group" title="journal-title-group"> <span class="journal-title" tagx="journal-title" title="journal-title">EJNMMI Physics</span> </div> <span class="issn-epub" tagx="issn" title="issn-epub">2197-7364</span> <div class="publisher" tagx="publisher" title="publisher"> <span class="publisher-name" tagx="publisher-name" title="publisher-name">Springer International Publishing</span> <span class="publisher-loc" tagx="publisher-loc" title="publisher-loc">Cham</span> </div> </div> <div class="article-meta" tagx="article-meta" title="article-meta"> <span class="pmcid" title="pmcid"> pmcid: <a href="http://www.ncbi.nlm.nih.gov/pubmed/6663957">6663957</a> </span> <span class="publisher-id" title="publisher-id">248</span> <span class="doi" title="doi"> doi: <a href="https://dx.doi.org/10.1186/s40658-019-0248-9">10.1186/s40658-019-0248-9</a> </span> <div class="article-categories" title="article-categories">
: <span class="subject" title="subject">Original Research</span> </div> <div class="title-group"> <div class="article-title" title="article-title">
Implementation of cylindrical PET scanners with block detector geometry in STIR</div> </div> <div class="contrib-group" title="contrib-group"> <span class="contrib" title="contrib"> <span class="contrib-id" tagx="contrib-id" title="contrib-id">http://orcid.org/0000-0002-8563-3450</span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Khateri</span> <span class="given-names" tagx="given-names" title="given-names">Parisa</span> </span> <span class="address" title="address"> <span class="email" tagx="email" title="email">pkhateri@phys.ethz.ch</span> </span> <a href="#Aff1">1</a> </span> <span class="contrib" title="contrib"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Fischer</span> <span class="given-names" tagx="given-names" title="given-names">Jannis</span> </span> <span class="address" title="address"> <span class="email" tagx="email" title="email">fischeja@phys.ethz.ch</span> </span> <a href="#Aff1">1</a> </span> <span class="contrib" title="contrib"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Lustermann</span> <span class="given-names" tagx="given-names" title="given-names">Werner</span> </span> <span class="address" title="address"> <span class="email" tagx="email" title="email">Werner.Lustermann@cern.ch</span> </span> <a href="#Aff1">1</a> </span> <span class="contrib" title="contrib"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Tsoumpas</span> <span class="given-names" tagx="given-names" title="given-names">Charalampos</span> </span> <span class="address" title="address"> <span class="email" tagx="email" title="email">C.Tsoumpas@leeds.ac.uk</span> </span> <a href="#Aff2">2</a> </span> <span class="contrib" title="contrib"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Dissertori</span> <span class="given-names" tagx="given-names" title="given-names">Günther</span> </span> <span class="address" title="address"> <span class="phone" tagx="phone" title="phone">+41 44 633 42 88</span> <span class="email" tagx="email" title="email">disserto@phys.ethz.ch</span> </span> <a href="#Aff1">1</a> </span> <span class="citation_author_institution" id="Aff1">[1], <div class="institution-wrap" title="institution-wrap"> <span class="institution-id" title="institution-id">0000 0001 2156 2780</span> <span class="institution-id" title="institution-id">grid.5801.c</span> <span class="institution" title="institution">Institute for Particle Physics and Astrophysics, Department of Physics, </span> <span class="institution" title="institution">ETH Zürich, </span> </div> </span> <span class="citation_author_institution" id="Aff2">[2], <div class="institution-wrap" title="institution-wrap"> <span class="institution-id" title="institution-id">0000 0004 1936 8403</span> <span class="institution-id" title="institution-id">grid.9909.9</span> <span class="institution" title="institution">Leeds Institute of Cardiovascular and Metabolic Medicine, </span> <span class="institution" title="institution">University of Leeds, </span> </div> </span> </div> <span class="pub-date-epub" title="pub-date-epub">epub: <span>2019-7-7</span> </span> <span class="pub-date-pmc-release" title="pub-date-pmc-release">pmc-release: <span>2019-7-7</span> </span> <span class="pub-date-collection" title="pub-date-collection">collection: <span>2019-12</span> </span> <span class="volume" tagx="volume" title="volume">6</span> <span class="elocation-id" tagx="elocation-id" title="elocation-id">15</span> <span class="history" title="history"> <span class="received" title="received">received: 2018-11-1</span> <span class="accepted" title="accepted">accepted: 2019-7-5</span> </span> <div class="permissions"> <span class="copyright" title="copyright">(C) , </span> <span class="license" title="license"> <span class="license-p" title="license-p"> <b>Open Access</b>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License ( <a href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</a>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. </span> </span> </div> <div class="abstract" title="abstract"> <div class="abstract-title" title="abstract-title">
Abstract</div> <div class="background" title="sec"> <div class="title" tagx="title" title="title">
Background</div> <p>Software for Tomographic Image Reconstruction (STIR) is an open-source library for PET and SPECT image reconstruction, implementing iterative reconstruction as well as 2D- and 3D-filtered back projection. Quantitative reconstruction of PET data requires the knowledge of the scanner geometry. Typical scanners, clinical as well as pre-clinical ones, use a block-type geometry. Several rectangular blocks of crystals are arranged into regular polygons. Multiple of such polygons are arranged along the scanner axis. However, the geometrical representation of a scanner provided by STIR is a cylinder made of rings of individual crystals equally distributed in axial and transaxial directions. The data of realistic scanners are projected onto such virtual scanners prior to image reconstruction. This results in reduced quality of the reconstructed image. In this study, we implemented the above-described block geometry into the STIR library, permitting the image reconstruction without the interpolation step. In order to evaluate the difference in image quality, we performed Monte Carlo simulation studies of three different scanner designs: two scanners with multiple crystals per block and one with a single crystal per block. Simulated data were reconstructed using the standard STIR method and the newly implemented block geometry. </p> </div> <div class="results" title="sec"> <div class="title" tagx="title" title="title">
Results</div> <p>Visual comparison between the images reconstructed by the two models for the block-type scanners shows that the new implementation enhances the image quality to the extent that the results before normalization correction are comparable with those after normalization correction. The simulation result of a uniform cylinder shows that the coefficient of variation decreases from 25.8% to 20.9% by using the new implementation in STIR. Spatial resolution is enhanced resulting in a lower partial loss of intensity in sources of small size, e.g., the spill-over ratio for spherical sources of 1.8 mm diameter is 0.19 in the block and 0.34 in the cylindrical model. </p> </div> <div class="conclusions" title="sec"> <div class="title" tagx="title" title="title">
Conclusions</div> <p>Results indicate a significant improvement for the new model in comparison with the old one which mapped the polygonal geometry into a cylinder. The new implementation was tested and is available for use via the library of Swiss Federal Institute of Technology in Zurich (ETH). </p> </div> </div> <div class="kwd-group"> <div class="title" tagx="title" title="title">
Keywords</div> <div class="kwd" title="kwd">
PET image reconstruction</div> <div class="kwd" title="kwd">
SAFIR</div> <div class="kwd" title="kwd">
Scanner geometry</div> <div class="kwd" title="kwd">
STIR</div> </div> <div class="funding-group" title="funding-group"> <div class="funding" title="funding">
Funding</div> <div class="award-group" title="award-group"> <div class="funding-source" title="funding-source"> <div class="institution-wrap" title="institution-wrap"> <span class="institution-id" title="institution-id">http://dx.doi.org/10.13039/501100003006</span> <span class="institution" title="institution">Eidgenössische Technische Hochschule Zürich</span> </div> </div> <span class="award-id" tagx="award-id" title="award-id">ETH-30 14-2</span> </div> </div> <div class="custom-meta-group" title="custom-meta-group"> <meta name="issue-copyright-statement" value="© The Author(s) 2019" /> </div> </div> </div> <div class="body" title="body"> <div class="background" title="sec"> <div class="title" tagx="title" title="title">
Background</div> <p>Positron emission tomography (PET) allows quantitative imaging of the radiotracer’s distribution inside the object under study. There is a strong demand in pre-clinical PET imaging for accurate reconstruction procedure to acquire quantitative images of high spatial resolution. Iterative image reconstruction methods are especially of interest as they yield accurate quantitative images [ <a href="#CR1">1</a>]. They can incorporate physical effects of the system into the reconstruction model and enhance the spatial resolution [ <a href="#CR2">2</a>]. One of the fundamental components in iterative reconstruction algorithms is the system matrix which models the scanner response [ <a href="#CR3">3</a>, <a href="#CR4">4</a>]. Different methods have been developed to derive the system matrix. One method is to measure a point source located in different positions in the scanner field of view (FOV) [ <a href="#CR5">5</a>]. Another approach is to obtain the system matrix using Monte Carlo simulation [ <a href="#CR6">6</a>, <a href="#CR7">7</a>]. Such simulations can include both geometrical and physical properties of the system but they are computationally challenging. An alternative is to analytically calculate the line of intersection between image voxels and lines of response (LOR) [ <a href="#CR8">8</a>]. In the analytical approach, the system matrix can be decomposed into different components to take into account various resolution-degrading effects [ <a href="#CR9">9</a>, <a href="#CR10">10</a>], as follows: </p><div class="disp-formula" title="disp-formula"> <span class="label" tagx="label" title="label">1</span> <div class="alternatives" title="alternatives"> <div class="tex" title="tex"> <div class="tex-math_UNKNOWN" id="M1">
\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$ q= NLXf+s+r $$\end{document} </div> </div> <div class="math_UNKNOWN"> <div class="mi_UNKNOWN">
q</div> <div class="mo_UNKNOWN">
=</div> <div class="mtext_UNKNOWN">
NLXf</div> <div class="mo_UNKNOWN">
+</div> <div class="mi_UNKNOWN">
s</div> <div class="mo_UNKNOWN">
+</div> <div class="mi_UNKNOWN">
r</div> </div> <div class="graphic_UNKNOWN" /> </div> </div> <p /> <p>This equation is used as the forward model in the well-known expectation maximization algorithm [ <a href="#CR1">1</a>, <a href="#CR11">11</a>]. It describes the mean of the measured data, vector <b> <i>q</i> </b>, as a function of the radiotracer’s distribution, vector <b> <i>f</i> </b>. Diagonal matrices of <i>N</i> and <i>L</i> represent normalization and attenuation correction, respectively. Vectors of <b> <i>s</i> </b> and <b> <i>r</i> </b> are estimates of the mean of scatter and random events, respectively. Matrix <i>X</i> is the geometric model that relates the projection space to the image space. This geometric element is directly dependent on the model of the scanner geometry. In this study, we concentrate on this key component of the system matrix and in particular its implementation in STIR (Software for Tomographic Image Reconstruction) [ <a href="#CR12">12</a>]. STIR is an open-source library for PET and SPECT image reconstruction, implementing analytical as well as iterative reconstruction. Within STIR, the system matrix is calculated based on the analytical method with the Siddon raytracing algorithm [ <a href="#CR13">13</a>]. The geometrical representation of a scanner provided by STIR is a cylinder made of rings of individual crystals equally distributed in axial and transaxial directions. The data of realistic scanners are projected onto such virtual scanners prior to image reconstruction. Whereas, typical scanners, clinical as well as pre-clinical ones, use a block-type geometry. Several rectangular blocks of crystals are arranged into regular polygons. Multiple of such polygons are arranged, with equal spacing, along the scanner axis. Gaps between individual crystals within a block are typically different from the gaps between the blocks in axial and transaxial directions. The difference between these two models, in a transaxial direction, is schematically shown in Fig. <a href="#Fig1">1</a>. </p><div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/"> <span class="label" tagx="label" title="label">Fig. 1</span> </a> </div>   <p>Schematics of scanner models. <b>a</b> Cylindrical geometry. <b>b</b> Block geometry </p>   </div> <p /> <p>We implemented the block geometry in both axial and transaxial directions in the STIR library and investigated if the implementation of such a realistic model is worth the time and computational expense. The new implemented model permits the image reconstruction without the interpolation step. Therefore, LORs can be described more accurately which in turn leads to more accurate localization of radiotracers. Details of the implementation along with the evaluation of the reconstruction are described in the next sections. </p> </div> <div class="methods" title="sec"> <div class="title" tagx="title" title="title">
Methods</div> <div class="softwareimplementation" title="sec"> <div class="title" tagx="title" title="title">
Software implementation</div> <p>The new block geometry was implemented in STIR version 3.0. STIR makes use of the object-oriented features of C++. The library contains main building blocks including categorized classes to describe certain kinds of object with their functionalities, e.g., to describe images, 3D sinograms, forward/backward projection, iterative image reconstruction algorithms, and reading/writing interfile headers (I/O) [ <a href="#CR12">12</a>]. We now describe these features in more detail. </p> <p>The class <i>Scanner</i> describes the characteristics of a cylindrical scanner with discrete detectors. It lacks parameters to be able to model the exact block geometry, e.g., the distance between crystals in the axial and transaxial directions and the distance between blocks in the axial direction. We added these new parameters to the class <i>Scanner</i> and to the I/O-related classes accordingly. Moreover, the interfile headers were modified such that the user can choose at run-time which geometry to use, either <i>cylindrical</i> or <i>blocks-on-cylindrical</i>. </p> <p>The library has been extended to be able to read custom input file formats, for instance, the Small Animal PET Insert For MRI (SAFIR) list-mode data for a cylindrical scanner, and to histogram them in 3D sinograms [ <a href="#CR14">14</a>]. This part was adapted to cope with the new block geometry as well. In the cylindrical implementation, sinogram bin parameters are found from the LOR Cartesian coordinates. Bin parameters are segment, axial-position, view, and tangential-position numbers. We overloaded a function to calculate the sinogram bin parameters directly from the detector position numbers. </p> <p>The most important building block to modify was the one related to sinograms and forward/backward projection. New classes were inherited in which the 3D-sinogram information could be calculated according to the new scanner geometry. Figure <a href="#Fig2">2</a> demonstrates the related class hierarchy. In the former model, the LOR coordinates are calculated based on detector position numbers with the assumption of having a perfect cylindrical scanner. In the current implementation, we calculate LOR coordinates from the exact Cartesian coordinates of the two detection positions. The detection positions are calculated based on the average depth of interaction inside the crystals. In both geometries, it is possible to use LOR sampling in a tangential direction. It means that multiple rays could be used in raytracing for each detector pair. In this case, the spatial sampling is evenly distributed and the result is averaged over different LORs. </p><div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/"> <span class="label" tagx="label" title="label">Fig. 2</span> </a> </div>   <p>Class hierarchy related to sinogram data. Arrows indicate the parent class. Gray boxes show the new classes added to the library. The classes <i>ProjDataInfoBlocksOnCylindrical</i> and <i>ProjDataInfoBlocksOnCylindricalNoArcCorr</i> store and calculate the sinogram LOR and bin information for the block geometry. The class <i>GeometryBlocksOnCylindrical</i> builds a map of Cartesian coordinates of detectors according to the scanner geometry </p>   </div> <p /> </div> <div class="montecarlosimulations" title="sec"> <div class="title" tagx="title" title="title">
Monte Carlo simulations</div> <p>We simulated three sets of PET data with different scanner designs using Geant4 toolkit v10.2 [ <a href="#CR15">15</a>] and Gate v7.2 [ <a href="#CR16">16</a>]: a scanner with a single crystal per block to test the code implementation and two scanners with multiple crystals per block but different crystal sizes to evaluate the new model. Details of the simulation setup are described as follows. </p> <div class="thescannerwithasinglecrystalperblock—scannera" title="sec"> <div class="title" tagx="title" title="title">
The scanner with a single crystal per block—Scanner A</div> <p>This scanner, simulated using Geant4 toolkit, is built of 41 rings evenly distributed in axial direction comprising 180 detector elements uniformly distributed per ring. The crystal size is 2.0 × 2.0 × 12.0 mm <sup>3</sup>, and the inner ring radius is 63.02 mm. The crystal pitches in axial and transaxial directions are 2.2 mm. </p> <p>A Derenzo phantom with spherical sources of 1.0, 1.2, 1.6, 2.4, 3.2, and 4.0 mm diameter was simulated inside this scanner. The spheres were filled with 500 MBq of <sup>18</sup>F and located inside a water cylinder with 25 mm diameter. The activity was distributed uniformly inside the spheres. Simulation was performed for 5 s. </p> </div> <div class="theblock-typescannerwith2.1 × 2.1 × 12 mm3crystals—scannerb" title="sec"> <div class="title" tagx="title" title="title">
The block-type scanner with 2.1 × 2.1 × 12 mm <sup>3</sup> crystals—Scanner B </div> <p>The geometry of this scanner is similar to the SAFIR prototype scanner [ <a href="#CR17">17</a>]. It is composed of 2 (24) blocks of 8 × 8 detectors in axial (transaxial) direction. The blocks are arranged on a dodecagon prism, i.e., there are two blocks per module, each module on one side of the prism. The inner radius of the scanner is 67.75 mm. The crystal size is 2.1 × 2.1 × 12.0 mm <sup>3</sup>. Crystal gap and block gap are 0.1 mm and 0.6 mm, respectively, in both axial and transaxial directions. </p> <p>Several phantoms were simulated inside this scanner using Gate v7.2. The first one was a rotating plane (32 mm × 120 mm) source simulated to find the normalization correction factors. The plane was rotated at six equally spaced angles over a total of 180°. Since the scanner has 12 modules of detector blocks, this assures that the number of detected LORs, which are orthogonal to the plane, is maximized. The source activity was set to 10 MBq at each angular position. The acquisition time was 80 min per position. We used back-to-back emission of two 511-keV gammas, thus, the non-collinearity and positron range was not simulated in this set of data. The plane was filled with air to avoid scatter and attenuation effects. The decay was turned off. This increases the statistics per detector pair and therefore reduces the statistical error introduced by the normalization. </p> <p>A uniform water-filled cylinder (25 mm × 60 mm Ø) which contained 100 MBq of <sup>18</sup>F was simulated for 2.5 min. </p> <p>A point source consisting of 10 MBq of <sup>22</sup>Na was embedded inside an acrylic cube of 10.0 mm extended on all sides as suggested in NEMA NU 4 [ <a href="#CR18">18</a>]. The source was located at the axial center and one-fourth of the axial FOV. For both axial positions, the source was moved radially at positions of 0.0, 5.0, 10.0, 15.0, 20.0, 25.0 mm. 10 <sup>5</sup> prompts were stored for each position. </p> <p>A Derenzo phantom with sphere diameters of 1.6, 1.8, 2.0, 2.2, 2.4, and 2.8 mm made of water was used in order to evaluate the effect of spatial resolution on the image quality. The initial activity of 100 MBq of <sup>18</sup>F was distributed uniformly inside the spheres, with the same activity per volume in the spheres. The acquisition time was 5 s. The spheres were located inside a water cylinder with 25 mm length and 30 mm diameter. Therefore, the effect of positron range was present in the simulation. </p> <p>The image quality phantom as described in NEMA NU 4 [ <a href="#CR18">18</a>] consisting of 3.7 MBq of <sup>18</sup>F was simulated for 20 min. The image quality phantom has two parts. One part of 20 mm inner length includes five hot rods of different diameters (1.0, 2.0, 3.0, 4.0, and 5.0 mm) inside a polymethylmethacrylate (PMMA) cylinder. The other part of 30 mm inner length comprises of two cold rods of the same diameter (8.0 mm) inside a hot cylinder. Since the scanner is not long enough to cover the whole phantom, we had to repeat the same simulation with two different axial positions of the phantom so that in each simulation, one part is axially centered in the scanner. </p> </div> <div class="theblock-typescannerwith1 × 1 × 10 mm3crystals—scannerc" title="sec"> <div class="title" tagx="title" title="title">
The block-type scanner with 1 × 1 × 10 mm <sup>3</sup> crystals—Scanner C </div> <p>In order to validate if the results are independent of the crystal size, a similar block-type scanner with smaller crystals (1.0 × 1.0 × 10.0 mm <sup>3</sup>) was simulated using Gate v7.2. The scanner is made of 2 (24) blocks of 16 × 16 detectors in an axial (transaxial) direction where the blocks are arranged on a dodecagon prism. The inner radius of the scanner is 67 mm. Cristal gap and block gap are 0.1 and 0.3, respectively. </p> <p>A Derenzo phantom, with spheres of 0.6, 0.8, 1.0, 1.2, 1.5, and 2.0 mm diameter made of water was placed inside the scanner. The spheres were uniformly filled by the total activity of 100 MBq of <sup>18</sup>F and were simulated for 5 s. The spheres were located inside a water cylinder with 25 mm length and 30 mm diameter. </p> </div> </div> <div class="sortingcoincidencedata" title="sec"> <div class="title" tagx="title" title="title">
Sorting coincidence data</div> <p>The coincidence data were sorted using a coincidence time window of 1 ns and an energy window from 350 keV to 650 keV which is common in preclinical studies. Random events were removed from simulated data by checking the event history in the Monte Carlo simulation data. </p> <p>List-mode simulated data were histogrammed into 3D sinograms of types block and cylindrical. Each sinogram bin represents one LOR, i.e., no compression was implemented in axial and transaxial directions. The sizes of sinogram data for the three scanners are summarized in Table <a href="#Tab1">1</a>. <div class="table-wrap_UNKNOWN"> <span class="label" tagx="label" title="label">Table 1</span>  </div></p><p>Size of sinograms and images with their dimensions for the three different scanners</p>  <table> <thead> <tr> <th>Scanner</th> <th>Size of sinograms</th> <th>1Number of sinograms</th> <th>Number of image voxels</th> <th>Image voxel size (mm <sup>3</sup>) </th> </tr> </thead> <tbody> <tr> <td>Scanner A</td> <td>90 × 60</td> <td>1681</td> <td>127 × 127 × 81</td> <td>0.55 × 0.55 × 1.1</td> </tr> <tr> <td>Scanner B</td> <td>   96 × 100</td> <td>256</td> <td>129 × 129 × 31</td> <td>0.55 × 0.55 × 1.1</td> </tr> <tr> <td>Scanner C</td> <td>192 × 100</td> <td>1024</td> <td>213 × 213 × 63</td> <td>0.257 × 0.257 × 0.55</td> </tr> </tbody> </table>  <p /> </div> <div class="normalization" title="sec"> <div class="title" tagx="title" title="title">
Normalization</div> <p>Normalization factors were only calculated for the <i>Scanner B</i>. The method described by Bailey et al. [ <a href="#CR19">19</a>] was adapted for this purpose in the following manner. Six data sets were acquired from six angular positions of the plane. The goal was to extract the LORs that were almost orthogonal to the plane source at each position. We extracted 16 almost orthogonal views per position. Therefore, all views were covered because there were 96 views in total. The extracted views were assembled to build a complete 3D sinogram. The symmetric views and axial positions were added together to increase the statistics per sinogram bins. The average number of counts per sinogram bin was about 1000. This gives a statistical error of ~ 3.2%. The bin values were then inverted to calculate the normalization factors. The sinograms were trimmed to 160 tangential positions to remove bins out of the desired FOV. </p> </div> <div class="attenuationcorrection" title="sec"> <div class="title" tagx="title" title="title">
Attenuation correction</div> <p>Generation of the attenuation maps was quite straightforward since the data were from Monte Carlo simulation and we knew the exact phantom geometry and the material. The attenuation coefficient used for water was 0.096 cm <sup>−1</sup> at 511 keV [ <a href="#CR20">20</a>]. The attenuation correction sinograms were calculated from the exponential of the forward projection of the attenuation maps for both cylindrical and block geometries. </p> </div> <div class="scattercorrection" title="sec"> <div class="title" tagx="title" title="title">
Scatter correction</div> <p>The scatter estimation was performed using the current implementation of single scatter simulation (SSS) algorithm in STIR [ <a href="#CR21">21</a>] where the Klein-Nishina cross-section is used to calculate the probability of Compton scattering as a function of scattering angle. We calculated the down-sampled single scatter sinograms given: (i) the activity image which was reconstructed from non-scatter corrected data, (ii) the attenuation map, (iii) the attenuation map down-sampled with a factor of two, (iii) the scanner down-sampled with a factor of two in axial and transaxial directions keeping the same inner radius, (iv) the energy resolution of 20% similar to the simulation setup, (v) and the energy window of 350–650 keV. Then the result was up-sampled and fit to the activity image using Trispline interpolation. The down-sampling speeds up the process while it does not affect the final result significantly as the scatter distribution varies slowly with the detector pair. </p> </div> <div class="reconstruction" title="sec"> <div class="title" tagx="title" title="title">
Reconstruction</div> <p>Emission data were reconstructed using fully 3D-OSEM (ordered subsets expectation maximization) algorithm [ <a href="#CR22">22</a>]. The number of subsets was set to six for the Scanners B and C and to five for the <i>Scanner A</i>. The number of subiterations was 24 for all reconstructions. STIR is able to compute the Poisson log-likelihood and its gradient on distributed computing platforms using the Message Passing Interface (MPI). We ran the reconstruction on 16 Intel cores on one compute node (2 × Intel® Xeon® EP E5-2660 v2 (Ivy Bridge) at 2.2 GHz (10 cores/socket)) from Mönch cluster at the Swiss National Supercomputing Centre. The compute node had 32 GB of 1600 MHz DDR3 RAM. The nominal frequency of the CPU was 2.2 GHz. </p> <p>All ring differences were used in the reconstruction. The number of rays in tangential direction for raytracing each LOR was 10 for both block and cylindrical geometries. For the data from <i>Scanners B</i> and <i>C</i>, attenuation and scatter correction factors were included in the standard factorized system matrix. The data from the <i>Scanner B</i> were also corrected for normalization using the normalization factors calculated in the " <a href="#Sec9">Normalization</a>" section. The number of voxels in each direction and the voxel size for the three different scanners are summarized in Table <a href="#Tab1">1</a>. </p> </div> <div class="evaluation" title="sec"> <div class="title" tagx="title" title="title">
Evaluation</div> <p>A cylindrical region of interest (ROI) was drawn so that it covered the whole uniform cylinder phantom. The coefficient of variation (COV) was calculated as the ratio of the standard deviation (STD) to the mean of this ROI, similar to NEMA NU 4 [ <a href="#CR18">18</a>] to evaluate the uniformity. </p> <p>Line profiles were generated along spheres with a different diameter in Derenzo phantoms. The Derenzo data taken by the <i>Scanner B</i> were evaluated in more details in terms of peak-to-valley (PTV) and spill-over (SOR) ratios for both cylindrical and block models. Two ROIs were drawn around each individual sphere in the Derenzo phantom. One of them was a spherical ROI as large as the sphere itself, and the other an annular ROI with the inner diameter as large as the sphere diameter and the outer diameter twice the sphere diameter (Fig. <a href="#Fig10">10</a>). The SOR was calculated as the ratio of the mean of the annular ROI to the mean of the spherical ROI. </p> <p>The recovery coefficient (RC) as well as the percentage of its standard deviation (%STD) were calculated for the hot rods in the image quality phantom as described in NEMA NU 4 [ <a href="#CR18">18</a>]. </p> <p>The cylindrical and block models were also evaluated in terms of time and memory consumption. For this purpose, the computations were performed on a single core of a local computer (Intel® Core™ i7-4710MQ CPU at 2.50 GHz × 8). Single forward and backward projections as well as iterative OSEM reconstruction were implemented on a data set from the <i>Scanner B</i> with different sizes of the system matrix. In order to create different sizes for the system matrix, maximum ring difference of the 3D sinogram was changed from 0 to 15 by steps of 5. The number of subsets and subiterations for the OSEM algorithm were six and 12, respectively. The OSEM reconstruction was run without using the MPI option and with caching the system matrix enabled. Currently, the standard cylindrical model utilized symmetries existing in the system matrix in axial and transaxial directions. The number of symmetries in the block geometry is smaller than the cylindrical geometry. Only axial symmetries have been implemented for the block model in the new version. </p> </div> </div> <div class="results" title="sec"> <div class="title" tagx="title" title="title">
Results</div> <div class="thescannerwithasinglecrystalperblock—scannera" title="sec"> <div class="title" tagx="title" title="title">
The scanner with a single crystal per block—Scanner A</div> <p>The comparison of the new implementation with the standard cylindrical implementation in STIR was performed without correcting data prior or during image reconstruction. The results from block and cylindrical model show equal reconstruction performance, however, not identical (Fig. <a href="#Fig3">3</a>). The reason is that the cylindrical model even for such a scanner design uses approximation to calculate LOR coordinates given sinogram bins. For instance, it assigns the same azimuthal angle to two tangentially adjacent LORs with slightly different azimuthal angles. The difference image in Fig. <a href="#Fig3">3</a>c illustrates this rotational difference between the images. The line profile plotted across images indicates the difference between voxel values across the line. Maximum relative difference between the images calculated over a cylindrical ROI (6 mm × 50 mm Ø) was 10%. </p><div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/"> <span class="label" tagx="label" title="label">Fig. 3</span> </a> </div>   <p>Images of the Derenzo phantom simulated inside the <i>Scanner A</i> reconstructed using OSEM algorithm with 5 subsets and 24 subiterations. <b>a</b> Cylindrical geometry, <b>b</b> block geometry, and <b>c</b> difference image as cylindrical subtracted from block. At the bottom-right, the line profiles through the sources of 1.2 mm and 2.4 mm diameter are plotted as well as the difference between the two line profiles. The color bar in the first row is common to both images </p>   </div> <p /> </div> <div class="theblock-typescannerwith2.1 × 2.1 × 12 mm3crystals—scannerb" title="sec"> <div class="title" tagx="title" title="title">
The block-type scanner with 2.1 × 2.1 × 12 mm <sup>3</sup> crystals—Scanner B </div> <p>For each angular position of the plane source, we simulated about 4.175 × 10 <sup>15</sup> counts in total. The maximum number of counts per sinogram bin for the block model was about 8.3 × 10 <sup>3</sup> and for the cylindrical one about 2 × 10 <sup>4</sup>. Figure <a href="#Fig4">4</a> shows direct sinograms from the plane source located perpendicular to the <i>y</i>-axis. Some of the bin values in the cylindrical model are always zero since no coincidence events fell into these bins. This is due to mapping the block-type scanner into a virtual cylindrical scanner. Normalization factors were calculated and histogrammed in sinogram bins. The zero bins in the measured sinograms of the cylindrical model have the highest intensity in the normalization sinograms as shown in Fig. <a href="#Fig4">4</a>c. The reason is because of the way the normalization sinograms are calculated, as inversions of the measured data. With a measured value of zero, we obtain the normalization value of infinity which is replaced in practice by a maximum value. </p><div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/"> <span class="label" tagx="label" title="label">Fig. 4</span> </a> </div>   <p>Direct sinograms in the center of the <i>Scanner B.</i> Rows and columns of the sinograms represent views and tangential positions, respectively. <b>a</b> Sinogram of the plane source located perpendicular to <i>y</i>-axis in cylindrical geometry, <b>b</b> Sinogram of the plane source located perpendicular to <i>y</i>-axis in block geometry, <b>c</b> normalization factors’ sinogram in cylindrical geometry, and <b>d</b> normalization factors’ sinogram in block geometry. The color bar in each row is common to both sinograms. However, for the cylindrical geometry, there are values which are more than the maximum value in the color bar. These values are depicted in white. Therefore in the sinogram ( <b>a</b>), bins are greater than or equal to 300, and in the sinogram ( <b>c</b>), bins greater than or equal to 0.0012 are white </p>   </div> <p /> <p>The reconstruction was performed using both scanner models. Figure <a href="#Fig5">5</a> shows the reconstructed images of the uniform cylinder phantom. The cylindrical model creates significant artifacts prior to normalization correction while the block model yields a smooth cylinder. The COV ratio for the block model is much smaller than the one for the cylindrical model (Table <a href="#Tab2">2</a>). After correcting for normalization, the block and cylindrical models show similar results. The COV ratio for the block model increases from 18.4% to 20.9%. Although, the block model is visibly more uniform than the cylindrical one after normalization. This can be inferred from the COV ratios in Table <a href="#Tab2">2</a> which shows the COV ratio for the block model is 19% better comparing to the cylindrical one, after normalization. </p><div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/"> <span class="label" tagx="label" title="label">Fig. 5</span> </a> </div>   <p>Images of the uniform cylinder phantom simulated inside the <i>Scanner B</i> reconstructed using OSEM algorithm with six subsets and 24 subiterations. <b>a</b> Cylindrical geometry without normalization, <b>b</b> block geometry without normalization, <b>c</b> cylindrical geometry with normalization, and <b>d</b> block geometry with normalization. The color bar in each row is common </p>   </div> <div class="table-wrap_UNKNOWN"> <span class="label" tagx="label" title="label">Table 2</span>  <p>The COV ratio for the uniform cylinder phantom</p>  <table> <thead> <tr> <th>Model</th> <th>COV</th> </tr> </thead> <tbody> <tr> <td>Cylindrical without normalization</td> <td>33.2%</td> </tr> <tr> <td>Block without normalization</td> <td>18.4%</td> </tr> <tr> <td>Cylindrical with normalization</td> <td>25.8%</td> </tr> <tr> <td>Block with normalization</td> <td>20.9%</td> </tr> </tbody> </table> </div> <p /> <p>The results for the spatial resolution test are shown in Figs. <a href="#Fig6">6</a> and <a href="#Fig7"> <b>7</b> </a>. Reconstructed images of the point source together with the radial and tangential line profiles indicate that the new implementation yields a sharper image with better localization of the point source (Fig. <a href="#Fig6">6</a>). For the point at 15 mm, the radial and tangential line profiles of the new implementation are very close to the ones of the standard cylindrical implementation. Figure <a href="#Fig7">7</a> shows the full width half maximum (FWHM) in radial, tangential, and axial directions measured for the two axial positions: at the center and at one-fourth of the axial FOV. Both axial positions show a similar pattern. Radial and tangential values of FWHM are significantly larger for the cylindrical model. In a radial direction, FWHM increases by moving to the edge of the scanner which is reasonable as the point radially moves to the edge. In the axial direction, the two models show almost the same FWHM except for the point radially centered and axially located at 8.9 mm from the center of FOV. The axial FWHMs are 1.5 mm and 1.2 mm, respectively, for the block and the cylindrical implementations. This could be due to the discretization artifact as for the axially centered position; the two models show similar results. </p><div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/"> <span class="label" tagx="label" title="label">Fig. 6</span> </a> </div>   <p>Images and line profiles of the point source simulated inside the <i>Scanner B</i> reconstructed using OSEM algorithm with six subsets and 24 subiterations. <b>a</b> Cylindrical geometry. <b>b</b> Block geometry. The top (bottom) row of line profiles is tangentially (radially) drawn across the point source. The position of the point source in the top row corresponds to those in the bottom row. The point source located at the center of the scanner moves radially till 25 mm with steps of 5 mm </p>   </div> <div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/"> <span class="label" tagx="label" title="label">Fig. 7</span> </a> </div>   <p>FWHM measurements for the point simulated inside the <i>Scanner B</i> reconstructed using OSEM algorithm with six subsets and 24 subiterations. The point source is axially at two different positions: the center of the scanner and one-fourth of the axial FOV. For both cases, it moves radially till 25 mm with steps of 5 mm. The FWHM values are plotted for three axial, tangential and radial directions for the block and cylindrical models </p>   </div> <p /> <p>Visual comparison between the reconstructed images of the Derenzo phantom indicates a significant improvement for the block model (Fig. <a href="#Fig8">8</a>). Smallest spheres of 1.6 mm diameter can be clearly resolved using the new model even without applying normalization. Whereas, it is not possible to distinguish between some sources of 1.6 mm diameter in the cylindrical model after applying normalization. A circular artifact is observed in Fig. <a href="#Fig8">8</a>a which stays after normalization in Fig. <a href="#Fig8">8</a>c. </p><div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/"> <span class="label" tagx="label" title="label">Fig. 8</span> </a> </div>   <p>Images of the Derenzo phantom simulated inside the <i>Scanner B</i> reconstructed using OSEM algorithm with six subsets and 24 subiterations. <b>a</b> Cylindrical geometry without normalization, <b>b</b> block geometry without normalization, <b>c</b> cylindrical geometry with normalization, and <b>d</b> block geometry with normalization. A circular artifact is observed in images <b>a</b> and <b>c</b>. Values on image <b>b</b> show the sphere diameters in millimeter </p>   </div> <p /> <p>Line profiles across spherical sources with different diameters are plotted in Fig. <a href="#Fig9">9</a>. The average PTV ratio for these line profiles is higher for the block model (Fig. <a href="#Fig11">11</a>). It is almost twice the cylindrical model, e.g., 3.63 and 2.07 for the 1.8 mm spheres, respectively. Line profiles indicate that the PTV ratio decreases from the peripheral area to the center of the phantom. It also decreases by decreasing the source size. </p><div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/"> <span class="label" tagx="label" title="label">Fig. 9</span> </a> </div>   <p>Line profiles across images of the Derenzo phantom simulated inside the <i>Scanner B</i> reconstructed using OSEM algorithm with six subsets and 24 subiterations with normalization. Each graph represents a different sphere size which is written on top of the graph. A schematic of line profiles is drawn at the bottom </p>   </div> <p /> <p>Figure <a href="#Fig10">10</a> indicates the mean value for spherical and annular ROIs in the Derenzo images. The values of spherical ROIs are higher for the block and those of the annular ROIs are higher for the cylindrical model. This implies a lower partial loss of intensity for the new model. The SOR of 1.8-mm spheres is 0.19 and 0.34 for the block and cylindrical geometries, respectively. This value increases by increasing the source size (Fig. <a href="#Fig11">11</a>). There is a little kink in the SOR graph at 2.2 mm. The reason is that the spheres of 2.2 mm diameter are more extended to the peripheral area of the field of view where the spatial resolution degrades and the partial volume effect is more visible. </p><div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/"> <span class="label" tagx="label" title="label">Fig. 10</span> </a> </div>   <p>Mean value for spherical and annular ROIs around all sources in the Derenzo image. Each graph represents a specific sphere size which is shown on top of the graph. The spherical ROI and the annular ROI are depicted by green and yellow, respectively, in the image in the third row </p>   </div> <div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/"> <span class="label" tagx="label" title="label">Fig. 11</span> </a> </div>   <p>SOR and PTV calculated for different source size in Derenzo phantom after normalization correction </p>   </div> <p /> <p>Similar to the uniform cylinder and the Derenzo phantoms, both parts of the image quality phantom show that the new model enhances the quality of the images (Fig. <a href="#Fig12">12</a>). The part with cold rods inside the hot cylinder shows similar artifact as the uniform cylinder phantom before normalization (Fig. <a href="#Fig12">12</a>a). After normalization, the two models visually show similar results. As for the hot rods inside the PMMA cylinder, it could be observed in Fig. <a href="#Fig12">12</a>c that the cylindrical model tends to intensify the central region. This is because the density of the LORs in the center for the virtual cylindrical model is higher than reality. The RC values as well as their %STDs are plotted in Fig. <a href="#Fig13">13</a> showing a higher RC and lower %STD for the block model. The RC values are especially higher for the rods of 2 mm and 3 mm diameters. </p><div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/"> <span class="label" tagx="label" title="label">Fig. 12</span> </a> </div>   <p>Images of the image quality phantom simulated inside the <i>Scanner B</i> reconstructed using OSEM algorithm with six subsets and 24 subiterations. Transverse planes through the part with the cold rods: <b>a</b> cylindrical geometry without normalization, <b>b</b> block geometry without normalization, <b>e</b> cylindrical geometry with normalization, and <b>f</b> block geometry with normalization. Transverse planes through the part with the hot rods: <b>c</b> cylindrical geometry without normalization, <b>d</b> block geometry without normalization, <b>g</b> cylindrical geometry with normalization, and <b>h</b> block geometry with normalization. The images are transverse planes through the part containing hot rods. The color bar in each row is common </p>   </div> <div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/"> <span class="label" tagx="label" title="label">Fig. 13</span> </a> </div>   <p>RC values together with their %STD for hot rods of different diameter in the image quality phantom </p>   </div> <p /> </div> <div class="theblock-typescannerwith1 × 1 × 10 mm3crystals—scannerc" title="sec"> <div class="title" tagx="title" title="title">
The block-type scanner with 1 × 1 × 10 mm <sup>3</sup> crystals—Scanner C </div> <p>Reconstructed images of the Derenzo phantom with spheres of 0.6 mm diameter simulated inside the <i>Scanner C</i> are demonstrated in Fig. <a href="#Fig14">14</a>. These results are without normalization correction. It can be seen that the new implementation enhances the image quality. The result from block model can resolve most spheres down to 0.8 mm diameter without normalization correction. However, neither of two models can distinguish between the smallest spheres which are about half the crystal pitch. The line profile across spheres of 0.8 mm and 2 mm diameter for both models indicates that the new model is less noisy comparing to the standard cylindrical model. The goal of this measurement was only to show that the new implementation works with smaller crystal size. Therefore, we did not perform the evaluation procedure as for the <i>Scanner B</i>. </p><div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/"> <span class="label" tagx="label" title="label">Fig. 14</span> </a> </div>   <p>Images of the Derenzo phantom simulated inside the <i>Scanner C</i> reconstructed using OSEM algorithm with six subsets and 24 subiterations. <b>a</b> Cylindrical geometry. <b>b</b> Block geometry. The images are not normalized. At the top, the line profiles through the sources of 0.8 mm and 2 mm diameter are plotted for the two models. Values on image <b>b</b> show the sphere diameters in millimeter </p>   </div> <p /> </div> <div class="timeandmemoryconsumptioninthetwomodels" title="sec"> <div class="title" tagx="title" title="title">
Time and memory consumption in the two models</div> <p>Figure <a href="#Fig15">15</a> summarizes the time and memory consumption versus the size of the system matrix. The measurements have been done for the two models for different algorithms, forward and backward projection as well as OESM reconstruction. The memory usage of the three processes does not vary so much for each model. However, the block model consumes much more comparing to the cylindrical one especially by increasing the size of the system matrix. For the OSEM algorithm with six subsets and 12 subiterations, the memory usage reaches 4.5 GB for the block model comparing to 0.25 GB for the cylindrical model. The increase of time is less significant than the memory consumption for the block mode comparing to the cylindrical model. For the largest system matrix, the OSEM algorithm lasts about 65 min for the block model while it is about 28 min for the cylindrical model. </p><div class="fig" title="fig"> <div class="figure" title="figure"> <a href="http://doi.org/"> <span class="label" tagx="label" title="label">Fig. 15</span> </a> </div>   <p>Time and memory consumption for different algorithms vs. the size of the system matrix for the two models. The top (bottom) row shows the memory (time) consumption. The first, second, and third columns represent the forward projection, backward projection, and OSEM algorithm with six subsets and 12 subiterations. Each plot consists of four different sizes of the system matrix which correspond to different maximum ring differences of 0, 5, 10, and 15 </p>   </div> <p /> </div> </div> <div class="discussion" title="sec"> <div class="title" tagx="title" title="title">
Discussion</div> <p>A precise scanner model is essential to build a precise system matrix in the PET reconstruction. Simplified assumptions could cause wrong LOR coordinates and therefore wrong positioning of the source distribution. The effect of remapping the scanner into a virtual cylindrical scanner varies for different scanner geometries. When STIR operates in the cylindrical mode, it maps the block-type scanner on a cylinder with the same inner radius. This means LOR coordinates in the cylindrical mode are slightly different compared to the block mode. For a given LOR—described with azimuthal angle, polar angle, axial position, and tangential position—STIR tries to find the corresponding sinogram bin. Since detector positions in the cylindrical mode are rearranged for a block-type scanner, LORs could be assigned to wrong bins. Some bins might be chosen more often than in the correct geometry and some bins might be never chosen (zero bins in Fig. <a href="#Fig4">4</a>a). Consequently, also the maximum number of counts per sinogram bin is different for the two models. This could be especially observed in the results for the rotating plane source which has a high statistics (Fig. <a href="#Fig4">4</a>). </p> <p>Using the more accurate block model, we expect to get smoother sinograms for the plane source (Fig. <a href="#Fig4">4</a>b), however, still not perfectly smooth. A slight non-uniformity is observed close to the edges of the detector blocks in the sinogram of the block model. This effect is well pronounced in Fig. <a href="#Fig4">4</a>d in the normalization sinogram which is the result of the superposition of the measured sinograms followed by an inversion. This slight non-uniformity, unlike the severe non-uniformity in the cylindrical model, is because of the crystal interference effect within a block. It is a pattern that is repeated for the detectors in every block [ <a href="#CR19">19</a>]. </p> <p>The normalization corrects the non-uniformity caused by geometric effects and the non-uniformity of detector responses. The latter does not exist in our simulations, and since the new implementation in STIR can more accurately model the block-type scanner, the non-uniformity in the sinogram and consequently in the image is reduced. Figure <a href="#Fig5">5</a>b indicates that the block model produces a uniform cylinder even before normalization. However, there is a small residual of non-uniformity that could be observed in the middle of the cylinder which disappear after normalization (Fig. <a href="#Fig5">5</a>d). </p> <p>On the other hand, the result of COV indicates that applying normalization correction introduces a noise into the image reconstructed by the block model. The reason is the limited statistics per LOR. Equation ( <a href="#Equ1">1</a>) shows that the uncertainty of a given voxel value increases corresponding to the number of bins contributing in calculation of that voxel, as well as the uncertainty of the normalization factors (3.2%). By increasing the statistics, the uncertainty in normalization factors decreases, and therefore, the noise introduced by normalization decreases. As an alternative, component-based methods could be used to find normalization factors with lower statistics. To investigate the effect of statistics on the image uniformity, we calculated the normalization factors with one-tenth of the current statistics. The reconstructed images using these normalization factors are much noisier. The COV for the lower statistics case is 42.8% compared to 20.9% calculated for the higher statistics case. </p> <p>In the Monte Carlo simulation, we did not simulate the non-uniformity of the detector responses, which in reality can add to the image noise. This means, in the real scanner, the proper normalization is essential to improve the uniformity even in the case of block implementation. Additional studies can be performed to assess the block model with real data acquired from different scanner designs such as the SAFIR scanner. </p> <p>As for the spatial resolution, the simulation results show that the new model improves the images compared to the standard cylindrical model. The line profiles across the point sources show that in the transaxial plane, the spatial source distribution is much sharper for the block model, while in the axial direction, the two models give similar results. The reason is that the difference between the two models in the axial direction is only a gap between the two detector blocks while in the transaxial plane, the difference is more significant because all detector elements are slightly dispositioned for the cylindrical model. </p> <p>The results from Derenzo phantom (Fig. <a href="#Fig8">8</a>) show that although normalization can improve the quality of the image for the cylindrical implementation, it still leaves artifacts in the reconstructed image. The normalized Derenzo image reconstructed with the cylindrical model in Fig. <a href="#Fig8">8</a>c shows a circular artifact. </p> <p>In the Derenzo phantom, it may look like the image intensity is higher in the center of the phantom, but this is not the case, because the average intensity stays the same across larger regions in the phantom. This can be inferred from the line profiles where the peak values decrease to the peripheral area but the valley values increase. This is due to the spill-over effect that is caused by degraded spatial resolution in the peripheral area. The SOR ratio is another evidence for this effect since it increases at the center of the phantom. </p> <p>RC values calculated for the image quality phantom show that the block model can better recover the intensity for the rods of 2 mm and 3 mm diameter. The block model decreases the partial volume effect and enhances the image contrast where the source size is close to the size of detector elements. For larger rods, the two models give similar results. The RC value for the smallest rod is not reliable due to the high %STD which is 90% and 140%, respectively, for the block and cylindrical model. The 1-mm rod is out of the resolution of the <i>Scanner B</i>. </p> <p>The use of more accurate block geometry is computationally more intensive as the number of symmetries in the block geometry is smaller than the cylindrical geometry. This means that more calculations are required for the system matrix elements in each forward/backward projection in the iterative reconstruction (Fig. <a href="#Fig15">15</a>). In the new implementation, the block geometry only utilizes symmetries in an axial direction. It would be useful to also implement symmetries in the transaxial direction to accelerate the computation. </p> <p>Since the implementation of block geometry in the STIR library was based on calculating LOR parameters directly from the Cartesian coordinates of detection points, this opens a door to extend the library to more generic geometries, i.e., to any arrangement of the so-called cylindrical PET scanners such that there is no limitation in the size and number of crystals, blocks of crystals, and modules of blocks as long as they stay in a ringed-shape geometry. </p> </div> <div class="conclusion" title="sec"> <div class="title" tagx="title" title="title">
Conclusion</div> <p>We implemented a more accurate scanner model for PET image reconstruction in the STIR library. Scanner geometries with the shape of a regular polygon can be modeled using the new implementation. The new implementation was tested and is available for use via the ETH library [ <a href="#CR23">23</a>]. The new model was evaluated in terms of spatial resolution, partial volume effect, and uniformity using Monte Carlo simulation of the Derenzo and a uniform cylinder phantom. Results indicate a significant improvement for the new model in comparison with the old one which re-sampled the data from a physical polygonal geometry into a virtual cylindrical scanner geometry. </p> </div> <div class="listofparameters" title="sec"> <div class="title" tagx="title" title="title">
List of parameters</div> <p> <b> <i>f</i> </b> (vector): the function of the radiotracer’s distribution </p> <p> <i>L</i> (diagonal matrices): attenuation correction factors </p> <p> <i>N</i> (diagonal matrices): normalization correction factors </p> <p> <b> <i>q</i> </b> (vector): the mean of the measured data </p> <p> <b> <i>r</i> </b> (vector): estimate of the mean random events </p> <p> <b> <i>s</i> </b> (vector): estimate of the mean of scatter events </p> <p> <i>X</i> (matrix): the geometric model that relates the projection space to the image space </p> </div> </div> <div class="back" title="back"> <div class="glossary" title="glossary"> <div class="title" tagx="title" title="title">
Abbreviations</div> <div class="def-list" title="def-list"> <div class="def-item" title="def-item"> <div class="term" title="term">
COV</div> <div class="def" title="def"> <p>Coefficient of variation</p> </div> </div> <div class="def-item" title="def-item"> <div class="term" title="term">
ETH</div> <div class="def" title="def"> <p>Swiss Federal Institute of Technology in Zurich</p> </div> </div> <div class="def-item" title="def-item"> <div class="term" title="term">
FOV</div> <div class="def" title="def"> <p>Field of view</p> </div> </div> <div class="def-item" title="def-item"> <div class="term" title="term">
FWHM</div> <div class="def" title="def"> <p>Full width half maximum</p> </div> </div> <div class="def-item" title="def-item"> <div class="term" title="term">
LOR</div> <div class="def" title="def"> <p>Line of response</p> </div> </div> <div class="def-item" title="def-item"> <div class="term" title="term">
MPI</div> <div class="def" title="def"> <p>Message Passing Interface</p> </div> </div> <div class="def-item" title="def-item"> <div class="term" title="term">
MRI</div> <div class="def" title="def"> <p>Magnetic resonance imaging</p> </div> </div> <div class="def-item" title="def-item"> <div class="term" title="term">
PET</div> <div class="def" title="def"> <p>Positron-emission tomography</p> </div> </div> <div class="def-item" title="def-item"> <div class="term" title="term">
PTV</div> <div class="def" title="def"> <p>Peak-to-valley</p> </div> </div> <div class="def-item" title="def-item"> <div class="term" title="term">
RC</div> <div class="def" title="def"> <p>Recovery coefficient</p> </div> </div> <div class="def-item" title="def-item"> <div class="term" title="term">
ROI</div> <div class="def" title="def"> <p>Region of interest</p> </div> </div> <div class="def-item" title="def-item"> <div class="term" title="term">
SAFIR</div> <div class="def" title="def"> <p>Small Animal Fast Insert for MRI</p> </div> </div> <div class="def-item" title="def-item"> <div class="term" title="term">
SOR</div> <div class="def" title="def"> <p>Spill-over ratio</p> </div> </div> <div class="def-item" title="def-item"> <div class="term" title="term">
STIR</div> <div class="def" title="def"> <p>Software for Tomographic Image Reconstruction</p> </div> </div> </div> </div> <div class="fn-group" title="fn-group"> <div class="fn-type-" title=""> <p> <b>Publisher’s Note</b> </p> <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations. </p> </div> </div> <div class="ack" title="ack"> <div class="title" tagx="title" title="title">
Acknowledgement</div> <p>We would like to thank Kris Thielemans from Institute of Nuclear Medicine, University College London who provided valuable advice in the early stages of this work. </p> <p>We are also grateful to Alexander Howard for the provision of the simulated data described in the " <a href="#Sec5">The scanner with a single crystal per block—Scanner A</a>" section. </p> <p>We acknowledge Christian Edwin Ritzer and Oliver Grimm for their critical review of the manuscript. </p> </div> <div class="title" tagx="title" title="title">
Authors’ contributions</div> <p>PK performed the experiments, developed the reconstruction software, built and ran the simulations, performed reconstructions and data analysis, and drafted the manuscript. JF initially provided ideas on code structure and implementation within STIR and created the coincidence sorter tool in the analysis chain. WL and CT were involved in the design of this study and provided advice on the development of the source code and various methodological approaches of the investigation. GD was involved in the organization and planning of the work and discussions on the results. All authors critically reviewed the manuscript. All authors read and approved the final manuscript. The author list is alphabetically ordered, except for the first and the last authors. </p> <div class="title" tagx="title" title="title">
Funding</div> <p>This work was supported by the ETH Zurich Foundation through Research Grant ETH-30 14-2. Charalampos Tsoumpas was supported by a Royal Society Industry Fellowship (IF170011). </p> <div class="title" tagx="title" title="title">
Availability of data and materials</div> <p>The new implementation for image reconstruction and details of software implementation and installation are available: 10.5905/ethz-1007-146. </p> <p>Simulated data cannot be provided, but the simulation procedure—phantoms and scanner geometry—has been described in the " <a href="#Sec4">Monte Carlo simulations</a>" section. Simulated data of any scanner, representable by the above-described block-type implementation in STIR, can be used to replicate the results and validate the findings, namely demonstrate the improved image quality, due to the proper representation of the scanner geometry. </p> <div class="title" tagx="title" title="title">
Ethics approval and consent to participate</div> <p>Not applicable.</p> <div class="title" tagx="title" title="title">
Consent for publication</div> <p>Not applicable.</p> <div class="title" tagx="title" title="title">
Competing interests</div> <p>The authors declare that they have no competing interests.</p> <div class="references">
References</div> <div tag="ref-list"> <ul> <div class="title" tagx="title" title="title">
References</div> <li tag="ref"> <a name="CR1" /> <span class="label" tagx="label" title="label">1.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Lange</span> <span class="given-names" tagx="given-names" title="given-names">K</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Carson</span> <span class="given-names" tagx="given-names" title="given-names">R</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">EM reconstruction algorithms for emission and transmission tomography</span> <span class="source" tagx="source" title="source">J Comput Assist Tomogr</span> <span class="year" tagx="year" title="year">1984</span> <span class="volume" tagx="volume" title="volume">8</span> <span class="issue" tagx="issue" title="issue">2</span> <span class="fpage" tagx="fpage" title="fpage">306</span> <span class="lpage" tagx="lpage" title="lpage">316</span> <span class="pub-id"> <a href="http://www.ncbi.nlm.nih.gov/pubmed/6608535">6608535</a> </span> </span> </li> <li tag="ref"> <a name="CR2" /> <span class="label" tagx="label" title="label">2.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Carson</span> <span class="given-names" tagx="given-names" title="given-names">RE</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Yan</span> <span class="given-names" tagx="given-names" title="given-names">Y</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Chodkowski</span> <span class="given-names" tagx="given-names" title="given-names">B</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Yap</span> <span class="given-names" tagx="given-names" title="given-names">TK</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Daube-Witherspoon</span> <span class="given-names" tagx="given-names" title="given-names">ME</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">Precision and accuracy of regional radioactivity quantitation using the maximum likelihood EM reconstruction algorithm </span> <span class="source" tagx="source" title="source">IEEE transactions on medical imaging</span> <span class="year" tagx="year" title="year">1994</span> <span class="volume" tagx="volume" title="volume">13</span> <span class="issue" tagx="issue" title="issue">3</span> <span class="fpage" tagx="fpage" title="fpage">526</span> <span class="lpage" tagx="lpage" title="lpage">537</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1109/42.310884">10.1109/42.310884</a> </span> <span class="pub-id"> <a href="http://www.ncbi.nlm.nih.gov/pubmed/18218528">18218528</a> </span> </span> </li> <li tag="ref"> <a name="CR3" /> <span class="label" tagx="label" title="label">3.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Mumcuoglu</span> <span class="given-names" tagx="given-names" title="given-names">EU</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Leahy</span> <span class="given-names" tagx="given-names" title="given-names">R</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Cherry</span> <span class="given-names" tagx="given-names" title="given-names">SR</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Zhou</span> <span class="given-names" tagx="given-names" title="given-names">Z</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">Fast gradient-based methods for Bayesian reconstruction of transmission and emission PET images </span> <span class="source" tagx="source" title="source">IEEE transactions on Medical Imaging</span> <span class="year" tagx="year" title="year">1994</span> <span class="volume" tagx="volume" title="volume">13</span> <span class="issue" tagx="issue" title="issue">4</span> <span class="fpage" tagx="fpage" title="fpage">687</span> <span class="lpage" tagx="lpage" title="lpage">701</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1109/42.363099">10.1109/42.363099</a> </span> <span class="pub-id"> <a href="http://www.ncbi.nlm.nih.gov/pubmed/18218547">18218547</a> </span> </span> </li> <li tag="ref"> <a name="CR4" /> <span class="label" tagx="label" title="label">4.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Qi</span> <span class="given-names" tagx="given-names" title="given-names">J</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Leahy</span> <span class="given-names" tagx="given-names" title="given-names">RM</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Cherry</span> <span class="given-names" tagx="given-names" title="given-names">SR</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Chatziioannou</span> <span class="given-names" tagx="given-names" title="given-names">A</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Farquhar</span> <span class="given-names" tagx="given-names" title="given-names">TH</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">High-resolution 3D Bayesian image reconstruction using the microPET small-animal scanner</span> <span class="source" tagx="source" title="source">Physics in medicine &amp;amp; biology</span> <span class="year" tagx="year" title="year">1998</span> <span class="volume" tagx="volume" title="volume">43</span> <span class="issue" tagx="issue" title="issue">4</span> <span class="fpage" tagx="fpage" title="fpage">1001</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1088/0031-9155/43/4/027">10.1088/0031-9155/43/4/027</a> </span> <span class="pub-id"> <a href="http://www.ncbi.nlm.nih.gov/pubmed/9572523">9572523</a> </span> </span> </li> <li tag="ref"> <a name="CR5" /> <span class="label" tagx="label" title="label">5.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Panin</span> <span class="given-names" tagx="given-names" title="given-names">V</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Kehren</span> <span class="given-names" tagx="given-names" title="given-names">F</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Rothfuss</span> <span class="given-names" tagx="given-names" title="given-names">H</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Hu</span> <span class="given-names" tagx="given-names" title="given-names">D</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Michel</span> <span class="given-names" tagx="given-names" title="given-names">C</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Casey</span> <span class="given-names" tagx="given-names" title="given-names">M</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">PET reconstruction with system matrix derived from point source measurements</span> <span class="source" tagx="source" title="source">IEEE transactions on nuclear science</span> <span class="year" tagx="year" title="year">2006</span> <span class="volume" tagx="volume" title="volume">53</span> <span class="issue" tagx="issue" title="issue">1</span> <span class="fpage" tagx="fpage" title="fpage">152</span> <span class="lpage" tagx="lpage" title="lpage">159</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1109/TNS.2005.862979">10.1109/TNS.2005.862979</a> </span> </span> </li> <li tag="ref"> <a name="CR6" /> <span class="label" tagx="label" title="label">6.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Rafecas</span> <span class="given-names" tagx="given-names" title="given-names">M.</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Mosler</span> <span class="given-names" tagx="given-names" title="given-names">B.</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Dietz</span> <span class="given-names" tagx="given-names" title="given-names">M.</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Pogl</span> <span class="given-names" tagx="given-names" title="given-names">M.</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Stamatakis</span> <span class="given-names" tagx="given-names" title="given-names">A.</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">McElroy</span> <span class="given-names" tagx="given-names" title="given-names">D.P.</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Ziegler</span> <span class="given-names" tagx="given-names" title="given-names">S.I.</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">Use of a Monte Carlo-based probability matrix for 3-D iterative reconstruction of MADPET-II data </span> <span class="source" tagx="source" title="source">IEEE Transactions on Nuclear Science</span> <span class="year" tagx="year" title="year">2004</span> <span class="volume" tagx="volume" title="volume">51</span> <span class="issue" tagx="issue" title="issue">5</span> <span class="fpage" tagx="fpage" title="fpage">2597</span> <span class="lpage" tagx="lpage" title="lpage">2605</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1109/TNS.2004.834827">10.1109/TNS.2004.834827</a> </span> </span> </li> <li tag="ref"> <a name="CR7" /> <span class="label" tagx="label" title="label">7.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Aguiar</span> <span class="given-names" tagx="given-names" title="given-names">Pablo</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Rafecas</span> <span class="given-names" tagx="given-names" title="given-names">Magdalena</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Ortuño</span> <span class="given-names" tagx="given-names" title="given-names">Juan Enrique</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Kontaxakis</span> <span class="given-names" tagx="given-names" title="given-names">George</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Santos</span> <span class="given-names" tagx="given-names" title="given-names">Andrés</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Pavía</span> <span class="given-names" tagx="given-names" title="given-names">Javier</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Ros</span> <span class="given-names" tagx="given-names" title="given-names">Domènec</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">Geometrical and Monte Carlo projectors in 3D PET reconstruction</span> <span class="source" tagx="source" title="source">Medical Physics</span> <span class="year" tagx="year" title="year">2010</span> <span class="volume" tagx="volume" title="volume">37</span> <span class="issue" tagx="issue" title="issue">11</span> <span class="fpage" tagx="fpage" title="fpage">5691</span> <span class="lpage" tagx="lpage" title="lpage">5702</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1118/1.3501884">10.1118/1.3501884</a> </span> <span class="pub-id"> <a href="http://www.ncbi.nlm.nih.gov/pubmed/21158281">21158281</a> </span> </span> </li> <li tag="ref"> <a name="CR8" /> <span class="label" tagx="label" title="label">8.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Joseph</span> <span class="given-names" tagx="given-names" title="given-names">PM</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">An improved algorithm for reprojecting rays through pixel images</span> <span class="source" tagx="source" title="source">IEEE transactions on medical imaging</span> <span class="year" tagx="year" title="year">1982</span> <span class="volume" tagx="volume" title="volume">1</span> <span class="issue" tagx="issue" title="issue">3</span> <span class="fpage" tagx="fpage" title="fpage">192</span> <span class="lpage" tagx="lpage" title="lpage">196</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1109/TMI.1982.4307572">10.1109/TMI.1982.4307572</a> </span> <span class="pub-id"> <a href="http://www.ncbi.nlm.nih.gov/pubmed/18238275">18238275</a> </span> </span> </li> <li tag="ref"> <a name="CR9" /> <span class="label" tagx="label" title="label">9.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Reader</span> <span class="given-names" tagx="given-names" title="given-names">AJ</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Zaidi</span> <span class="given-names" tagx="given-names" title="given-names">H</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">Advances in PET image reconstruction</span> <span class="source" tagx="source" title="source">PET clinics</span> <span class="year" tagx="year" title="year">2007</span> <span class="volume" tagx="volume" title="volume">2</span> <span class="issue" tagx="issue" title="issue">2</span> <span class="fpage" tagx="fpage" title="fpage">173</span> <span class="lpage" tagx="lpage" title="lpage">190</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1016/j.cpet.2007.08.001">10.1016/j.cpet.2007.08.001</a> </span> <span class="pub-id"> <a href="http://www.ncbi.nlm.nih.gov/pubmed/27157872">27157872</a> </span> </span> </li> <li tag="ref"> <a name="CR10" /> <span class="label" tagx="label" title="label">10.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Sureau</span> <span class="given-names" tagx="given-names" title="given-names">F. C.</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Reader</span> <span class="given-names" tagx="given-names" title="given-names">A. J.</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Comtat</span> <span class="given-names" tagx="given-names" title="given-names">C.</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Leroy</span> <span class="given-names" tagx="given-names" title="given-names">C.</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Ribeiro</span> <span class="given-names" tagx="given-names" title="given-names">M.-J.</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Buvat</span> <span class="given-names" tagx="given-names" title="given-names">I.</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Trebossen</span> <span class="given-names" tagx="given-names" title="given-names">R.</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">Impact of Image-Space Resolution Modeling for Studies with the High-Resolution Research Tomograph </span> <span class="source" tagx="source" title="source">Journal of Nuclear Medicine</span> <span class="year" tagx="year" title="year">2008</span> <span class="volume" tagx="volume" title="volume">49</span> <span class="issue" tagx="issue" title="issue">6</span> <span class="fpage" tagx="fpage" title="fpage">1000</span> <span class="lpage" tagx="lpage" title="lpage">1008</span> <span class="pub-id"> <a href="https://dx.doi.org/10.2967/jnumed.107.045351">10.2967/jnumed.107.045351</a> </span> <span class="pub-id"> <a href="http://www.ncbi.nlm.nih.gov/pubmed/18511844">18511844</a> </span> </span> </li> <li tag="ref"> <a name="CR11" /> <span class="label" tagx="label" title="label">11.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Shepp</span> <span class="given-names" tagx="given-names" title="given-names">LA</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Vardi</span> <span class="given-names" tagx="given-names" title="given-names">Y</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">Maximum likelihood reconstruction for emission tomography</span> <span class="source" tagx="source" title="source">IEEE transactions on medical imaging</span> <span class="year" tagx="year" title="year">1982</span> <span class="volume" tagx="volume" title="volume">1</span> <span class="issue" tagx="issue" title="issue">2</span> <span class="fpage" tagx="fpage" title="fpage">113</span> <span class="lpage" tagx="lpage" title="lpage">122</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1109/TMI.1982.4307558">10.1109/TMI.1982.4307558</a> </span> <span class="pub-id"> <a href="http://www.ncbi.nlm.nih.gov/pubmed/18238264">18238264</a> </span> </span> </li> <li tag="ref"> <a name="CR12" /> <span class="label" tagx="label" title="label">12.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Thielemans</span> <span class="given-names" tagx="given-names" title="given-names">Kris</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Tsoumpas</span> <span class="given-names" tagx="given-names" title="given-names">Charalampos</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Mustafovic</span> <span class="given-names" tagx="given-names" title="given-names">Sanida</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Beisel</span> <span class="given-names" tagx="given-names" title="given-names">Tobias</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Aguiar</span> <span class="given-names" tagx="given-names" title="given-names">Pablo</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Dikaios</span> <span class="given-names" tagx="given-names" title="given-names">Nikolaos</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Jacobson</span> <span class="given-names" tagx="given-names" title="given-names">Matthew W</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">STIR: software for tomographic image reconstruction release 2</span> <span class="source" tagx="source" title="source">Physics in Medicine and Biology</span> <span class="year" tagx="year" title="year">2012</span> <span class="volume" tagx="volume" title="volume">57</span> <span class="issue" tagx="issue" title="issue">4</span> <span class="fpage" tagx="fpage" title="fpage">867</span> <span class="lpage" tagx="lpage" title="lpage">883</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1088/0031-9155/57/4/867">10.1088/0031-9155/57/4/867</a> </span> <span class="pub-id"> <a href="http://www.ncbi.nlm.nih.gov/pubmed/22290410">22290410</a> </span> </span> </li> <li tag="ref"> <a name="CR13" /> <span class="label" tagx="label" title="label">13.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Siddon</span> <span class="given-names" tagx="given-names" title="given-names">RL</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">Fast calculation of the exact radiological path for a three-dimensional CT array</span> <span class="source" tagx="source" title="source">Medical physics</span> <span class="year" tagx="year" title="year">1985</span> <span class="volume" tagx="volume" title="volume">12</span> <span class="issue" tagx="issue" title="issue">2</span> <span class="fpage" tagx="fpage" title="fpage">252</span> <span class="lpage" tagx="lpage" title="lpage">255</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1118/1.595715">10.1118/1.595715</a> </span> <span class="pub-id"> <a href="http://www.ncbi.nlm.nih.gov/pubmed/4000088">4000088</a> </span> </span> </li> <li tag="ref"> <a name="CR14" /> <span class="label" tagx="label" title="label">14.</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation">Fischer J. SAFIR input file format for STIR [Online]. Available: 10.5905/ethz-1007-22.</span> </li> <li tag="ref"> <a name="CR15" /> <span class="label" tagx="label" title="label">15.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Allison</span> <span class="given-names" tagx="given-names" title="given-names">J</span> </span> <span class="etal" title="etal"> <i>et al.</i> </span> </span> <span class="mixed-article-title" title="mixed-article-title">Geant4 developments and applications</span> <span class="source" tagx="source" title="source">IEEE Transactions on nuclear science</span> <span class="year" tagx="year" title="year">2006</span> <span class="volume" tagx="volume" title="volume">53</span> <span class="issue" tagx="issue" title="issue">1</span> <span class="fpage" tagx="fpage" title="fpage">270</span> <span class="lpage" tagx="lpage" title="lpage">278</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1109/TNS.2006.869826">10.1109/TNS.2006.869826</a> </span> </span> </li> <li tag="ref"> <a name="CR16" /> <span class="label" tagx="label" title="label">16.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Jan</span> <span class="given-names" tagx="given-names" title="given-names">S</span> </span> <span class="etal" title="etal"> <i>et al.</i> </span> </span> <span class="mixed-article-title" title="mixed-article-title">GATE: a simulation toolkit for PET and SPECT</span> <span class="source" tagx="source" title="source">Physics in Medicine &amp;amp; Biology</span> <span class="year" tagx="year" title="year">2004</span> <span class="volume" tagx="volume" title="volume">49</span> <span class="issue" tagx="issue" title="issue">19</span> <span class="fpage" tagx="fpage" title="fpage">4543</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1088/0031-9155/49/19/007">10.1088/0031-9155/49/19/007</a> </span> <span class="pub-id"> <a href="http://www.ncbi.nlm.nih.gov/pubmed/15552416">15552416</a> </span> </span> </li> <li tag="ref"> <a name="CR17" /> <span class="label" tagx="label" title="label">17.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Becker</span> <span class="given-names" tagx="given-names" title="given-names">Robert</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Buck</span> <span class="given-names" tagx="given-names" title="given-names">Alfred</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Casella</span> <span class="given-names" tagx="given-names" title="given-names">Chiara</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Dissertori</span> <span class="given-names" tagx="given-names" title="given-names">Günther</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Fischer</span> <span class="given-names" tagx="given-names" title="given-names">Jannis</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Howard</span> <span class="given-names" tagx="given-names" title="given-names">Alexander</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Ito</span> <span class="given-names" tagx="given-names" title="given-names">Mikiko</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Khateri</span> <span class="given-names" tagx="given-names" title="given-names">Parisa</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Lustermann</span> <span class="given-names" tagx="given-names" title="given-names">Werner</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Oliver</span> <span class="given-names" tagx="given-names" title="given-names">Josep F.</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Röser</span> <span class="given-names" tagx="given-names" title="given-names">Ulf</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Warnock</span> <span class="given-names" tagx="given-names" title="given-names">Geoffrey</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Weber</span> <span class="given-names" tagx="given-names" title="given-names">Bruno</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">The SAFIR experiment: Concept, status and perspectives</span> <span class="source" tagx="source" title="source">Nuclear Instruments and Methods in Physics Research Section A: Accelerators, Spectrometers, Detectors and Associated Equipment </span> <span class="year" tagx="year" title="year">2017</span> <span class="volume" tagx="volume" title="volume">845</span> <span class="fpage" tagx="fpage" title="fpage">648</span> <span class="lpage" tagx="lpage" title="lpage">651</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1016/j.nima.2016.05.037">10.1016/j.nima.2016.05.037</a> </span> </span> </li> <li tag="ref"> <a name="CR18" /> <span class="label" tagx="label" title="label">18.</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation">N. E. M. Association. Performance measurements of small animal positron emission tomographs. <i>NEMA Standards Publication, NU4-2008</i>. 2008:1–23. </span> </li> <li tag="ref"> <a name="CR19" /> <span class="label" tagx="label" title="label">19.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Bailey</span> <span class="given-names" tagx="given-names" title="given-names">DL</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Townsend</span> <span class="given-names" tagx="given-names" title="given-names">DW</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Kinahan</span> <span class="given-names" tagx="given-names" title="given-names">PE</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Grootoonk</span> <span class="given-names" tagx="given-names" title="given-names">S</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Jones</span> <span class="given-names" tagx="given-names" title="given-names">T</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">An investigation of factors affecting detector and geometric correction in normalization of 3-D PET data </span> <span class="source" tagx="source" title="source">IEEE Transactions on Nuclear Science</span> <span class="year" tagx="year" title="year">1996</span> <span class="volume" tagx="volume" title="volume">43</span> <span class="issue" tagx="issue" title="issue">6</span> <span class="fpage" tagx="fpage" title="fpage">3300</span> <span class="lpage" tagx="lpage" title="lpage">3307</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1109/23.552739">10.1109/23.552739</a> </span> </span> </li> <li tag="ref"> <a name="CR20" /> <span class="label" tagx="label" title="label">20.</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation">Hubbell JH, Seltzer SM. Tables of X-ray mass attenuation coefficients and mass energy-absorption coefficients 1 keV to 20 MeV for elements Z= 1 to 92 and 48 additional substances of dosimetric interest, National Inst. of Standards and Technology-PL, Gaithersburg, MD (United States). Ionizing Radiation Div. 1995. </span> </li> <li tag="ref"> <a name="CR21" /> <span class="label" tagx="label" title="label">21.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Tsoumpas</span> <span class="given-names" tagx="given-names" title="given-names">C</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Aguiar</span> <span class="given-names" tagx="given-names" title="given-names">P</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Nikita</span> <span class="given-names" tagx="given-names" title="given-names">K</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Ros</span> <span class="given-names" tagx="given-names" title="given-names">D</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Thielemans</span> <span class="given-names" tagx="given-names" title="given-names">K</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">Evaluation of the single scatter simulation algorithm implemented in the STIR library</span> <span class="source" tagx="source" title="source">IEEE Symposium Conference Record Nuclear Science 2004</span> <span class="year" tagx="year" title="year">2004</span> <span class="volume" tagx="volume" title="volume">6</span> <span class="fpage" tagx="fpage" title="fpage">3361</span> <span class="lpage" tagx="lpage" title="lpage">3365</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1109/NSSMIC.2004.1466455">10.1109/NSSMIC.2004.1466455</a> </span> </span> </li> <li tag="ref"> <a name="CR22" /> <span class="label" tagx="label" title="label">22.</span> <span class="element-citation'"> <span class="person-group'"> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Hudson</span> <span class="given-names" tagx="given-names" title="given-names">HM</span> </span> <span class="name" tagx="name" title="name"> <span class="surname" tagx="surname" title="surname">Larkin</span> <span class="given-names" tagx="given-names" title="given-names">RS</span> </span> </span> <span class="mixed-article-title" title="mixed-article-title">Accelerated image reconstruction using ordered subsets of projection data</span> <span class="source" tagx="source" title="source">IEEE transactions on medical imaging</span> <span class="year" tagx="year" title="year">1994</span> <span class="volume" tagx="volume" title="volume">13</span> <span class="issue" tagx="issue" title="issue">4</span> <span class="fpage" tagx="fpage" title="fpage">601</span> <span class="lpage" tagx="lpage" title="lpage">609</span> <span class="pub-id"> <a href="https://dx.doi.org/10.1109/42.363108">10.1109/42.363108</a> </span> <span class="pub-id"> <a href="http://www.ncbi.nlm.nih.gov/pubmed/18218538">18218538</a> </span> </span> </li> <li tag="ref"> <a name="CR23" /> <span class="label" tagx="label" title="label">23.</span> <span class="mixed-citation" tagx="mixed-citation" title="mixed-citation">Khateri P. Block geometry in STIR [Online]. Available: 10.5905/ethz-1007-146.</span> </li> </ul> </div> </div>  </body></html>